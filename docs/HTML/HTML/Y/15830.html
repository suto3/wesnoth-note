<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>opponent</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.6' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/1230.html#L2252'>opponent</a>         2252 src/attack_prediction.cpp void combatant::fight(combatant&amp; opponent, bool levelup_considered)</span>
<span class='curline'><a href='../S/1230.html#L2255'>opponent</a>         2255 src/attack_prediction.cpp 	if(opponent.u_.firststrike &amp;&amp; !u_.firststrike) {</span>
<span class='curline'><a href='../S/1230.html#L2256'>opponent</a>         2256 src/attack_prediction.cpp 		opponent.fight(*this, levelup_considered);</span>
<span class='curline'><a href='../S/1230.html#L2264'>opponent</a>         2264 src/attack_prediction.cpp 	dump(opponent.u_);</span>
<span class='curline'><a href='../S/1230.html#L2268'>opponent</a>         2268 src/attack_prediction.cpp 	std::vector&lt;double&gt; prev = summary[0], opp_prev = opponent.summary[0];</span>
<span class='curline'><a href='../S/1230.html#L2269'>opponent</a>         2269 src/attack_prediction.cpp 	complex_fight(opponent, 1);</span>
<span class='curline'><a href='../S/1230.html#L2270'>opponent</a>         2270 src/attack_prediction.cpp 	std::vector&lt;double&gt; res = summary[0], opp_res = opponent.summary[0];</span>
<span class='curline'><a href='../S/1230.html#L2272'>opponent</a>         2272 src/attack_prediction.cpp 	opponent.summary[0] = opp_prev;</span>
<span class='curline'><a href='../S/1230.html#L2281'>opponent</a>         2281 src/attack_prediction.cpp 	double opp_already_dead = opponent.hp_dist[0];</span>
<span class='curline'><a href='../S/1230.html#L2286'>opponent</a>         2286 src/attack_prediction.cpp 	const std::vector&lt;combat_slice&gt; opp_split = split_summary(opponent.u_, opponent.summary);</span>
<span class='curline'><a href='../S/1230.html#L2289'>opponent</a>         2289 src/attack_prediction.cpp 		fight_complexity(split.size(), opp_split.size(), u_, opponent.u_) &gt; MONTE_CARLO_SIMULATION_THRESHOLD</span>
<span class='curline'><a href='../S/1230.html#L2295'>opponent</a>         2295 src/attack_prediction.cpp 		complex_fight(attack_prediction_mode::monte_carlo_simulation, u_, opponent.u_, u_.num_blows,</span>
<span class='curline'><a href='../S/1230.html#L2296'>opponent</a>         2296 src/attack_prediction.cpp 		              opponent.u_.num_blows, summary, opponent.summary, self_not_hit, opp_not_hit, levelup_considered, split,</span>
<span class='curline'><a href='../S/1230.html#L2297'>opponent</a>         2297 src/attack_prediction.cpp 		              opp_split, slowed, opponent.slowed);</span>
<span class='curline'><a href='../S/1230.html#L2300'>opponent</a>         2300 src/attack_prediction.cpp 		do_fight(u_, opponent.u_, u_.num_blows, opponent.u_.num_blows, summary, opponent.summary, self_not_hit,</span>
<span class='curline'><a href='../S/1230.html#L2318'>opponent</a>         2318 src/attack_prediction.cpp 				init_slice_summary(sit_opp_summary[0], opponent.summary[0], opp_split[t].begin_hp, opp_split[t].end_hp,</span>
<span class='curline'><a href='../S/1230.html#L2320'>opponent</a>         2320 src/attack_prediction.cpp 				init_slice_summary(sit_opp_summary[1], opponent.summary[1], opp_split[t].begin_hp, opp_split[t].end_hp,</span>
<span class='curline'><a href='../S/1230.html#L2328'>opponent</a>         2328 src/attack_prediction.cpp 				do_fight(u_, opponent.u_, split[s].strikes, opp_split[t].strikes, sit_summary, sit_opp_summary,</span>
<span class='curline'><a href='../S/1230.html#L2344'>opponent</a>         2344 src/attack_prediction.cpp 		opponent.summary[0].swap(opp_summary_result[0]);</span>
<span class='curline'><a href='../S/1230.html#L2345'>opponent</a>         2345 src/attack_prediction.cpp 		opponent.summary[1].swap(opp_summary_result[1]);</span>
<span class='curline'><a href='../S/1230.html#L2350'>opponent</a>         2350 src/attack_prediction.cpp 	assert(opponent.summary[0].size() == opp_res.size());</span>
<span class='curline'><a href='../S/1230.html#L2357'>opponent</a>         2357 src/attack_prediction.cpp 	for(unsigned int i = 0; i &lt; opponent.summary[0].size(); ++i) {</span>
<span class='curline'><a href='../S/1230.html#L2358'>opponent</a>         2358 src/attack_prediction.cpp 		if(std::fabs(opponent.summary[0][i] - opp_res[i]) &gt; 0.000001) {</span>
<span class='curline'><a href='../S/1230.html#L2359'>opponent</a>         2359 src/attack_prediction.cpp 			std::cerr &lt;&lt; "Mismatch for " &lt;&lt; i &lt;&lt; " hp: " &lt;&lt; opponent.summary[0][i] &lt;&lt; " should have been " &lt;&lt; opp_res[i] &lt;&lt; "\n";</span>
<span class='curline'><a href='../S/1230.html#L2375'>opponent</a>         2375 src/attack_prediction.cpp 	if(opponent.summary[1].empty()) {</span>
<span class='curline'><a href='../S/1230.html#L2376'>opponent</a>         2376 src/attack_prediction.cpp 		opponent.hp_dist = opponent.summary[0];</span>
<span class='curline'><a href='../S/1230.html#L2378'>opponent</a>         2378 src/attack_prediction.cpp 		const unsigned size = opponent.summary[0].size();</span>
<span class='curline'><a href='../S/1230.html#L2379'>opponent</a>         2379 src/attack_prediction.cpp 		opponent.hp_dist.resize(size);</span>
<span class='curline'><a href='../S/1230.html#L2381'>opponent</a>         2381 src/attack_prediction.cpp 			opponent.hp_dist[i] = opponent.summary[0][i] + opponent.summary[1][i];</span>
<span class='curline'><a href='../S/1230.html#L2388'>opponent</a>         2388 src/attack_prediction.cpp 	poisoned = calculate_probability_of_debuff(poisoned, opponent.u_.poisons, touched, 1.0 - hp_dist[0],</span>
<span class='curline'><a href='../S/1230.html#L2389'>opponent</a>         2389 src/attack_prediction.cpp 		u_.experience + game_config::kill_xp(opponent.u_.level) &gt;= u_.max_experience, opponent.hp_dist[0] - opp_already_dead);</span>
<span class='curline'><a href='../S/1230.html#L2390'>opponent</a>         2390 src/attack_prediction.cpp 	opponent.poisoned = calculate_probability_of_debuff(opponent.poisoned, u_.poisons, opp_touched, 1.0 - opponent.hp_dist[0],</span>
<span class='curline'><a href='../S/1230.html#L2391'>opponent</a>         2391 src/attack_prediction.cpp 		opponent.u_.experience + game_config::kill_xp(u_.level) &gt;= opponent.u_.max_experience, hp_dist[0] - self_already_dead);</span>
<span class='curline'><a href='../S/1230.html#L2394'>opponent</a>         2394 src/attack_prediction.cpp 		slowed = calculate_probability_of_debuff(slowed, opponent.u_.slows, touched, 1.0 - hp_dist[0],</span>
<span class='curline'><a href='../S/1230.html#L2395'>opponent</a>         2395 src/attack_prediction.cpp 			u_.experience + game_config::kill_xp(opponent.u_.level) &gt;= u_.max_experience, opponent.hp_dist[0] - opp_already_dead);</span>
<span class='curline'><a href='../S/1230.html#L2396'>opponent</a>         2396 src/attack_prediction.cpp 		opponent.slowed = calculate_probability_of_debuff(opponent.slowed, u_.slows, opp_touched, 1.0 - opponent.hp_dist[0],</span>
<span class='curline'><a href='../S/1230.html#L2397'>opponent</a>         2397 src/attack_prediction.cpp 			opponent.u_.experience + game_config::kill_xp(u_.level) &gt;= opponent.u_.max_experience, hp_dist[0] - self_already_dead);</span>
<span class='curline'><a href='../S/1230.html#L2404'>opponent</a>         2404 src/attack_prediction.cpp 		opponent.slowed = std::accumulate(opponent.summary[1].begin(), opponent.summary[1].end(), 0.0);</span>
<span class='curline'><a href='../S/1230.html#L2407'>opponent</a>         2407 src/attack_prediction.cpp 	if(u_.experience + opponent.u_.level &gt;= u_.max_experience) {</span>
<span class='curline'><a href='../S/1230.html#L2412'>opponent</a>         2412 src/attack_prediction.cpp 	if(opponent.u_.experience + u_.level &gt;= opponent.u_.max_experience) {</span>
<span class='curline'><a href='../S/1230.html#L2413'>opponent</a>         2413 src/attack_prediction.cpp 		opponent.poisoned = 0.0;</span>
<span class='curline'><a href='../S/1230.html#L2414'>opponent</a>         2414 src/attack_prediction.cpp 		opponent.slowed = 0.0;</span>
<span class='curline'><a href='../S/1230.html#L2418'>opponent</a>         2418 src/attack_prediction.cpp 	opponent.untouched *= opp_not_hit;</span>
<span class='curline'><a href='../S/991.html#L39'>opponent</a>           39 src/attack_prediction.hpp 	void fight(combatant &amp;opponent, bool levelup_considered=true);</span>
</pre>
</body>
</html>
