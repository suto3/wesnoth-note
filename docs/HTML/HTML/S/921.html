<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>src/campaign_server/campaign_server.cpp</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.6' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<a id='TOP' name='TOP'></a><h2 class='header'><a href='../mains.html'>root</a>/<a href='../files/5826.html'>src</a>/<a href='../files/5837.html'>campaign_server</a>/campaign_server.cpp</h2>
<em class='comment'>/* [&lt;][&gt;]<a href='#L72'>[^]</a><a href='#L859'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</em>
<hr />
<h2 class='header'>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L72' title='Defined at 72.'>authenticate</a></li>
<li><a href='#L77' title='Defined at 77.'>generate_salt</a></li>
<li><a href='#L92' title='Defined at 92.'>set_passphrase</a></li>
<li><a href='#L114' title='Defined at 114.'>flush_timer_</a></li>
<li><a href='#L156' title='Defined at 156.'>load_config</a></li>
<li><a href='#L224' title='Defined at 224.'>handle_new_client</a></li>
<li><a href='#L231' title='Defined at 231.'>handle_request</a></li>
<li><a href='#L256' title='Defined at 256.'>handle_read_from_fifo</a></li>
<li><a href='#L323' title='Defined at 323.'>handle_sighup</a></li>
<li><a href='#L336' title='Defined at 336.'>flush_cfg</a></li>
<li><a href='#L342' title='Defined at 342.'>handle_flush</a></li>
<li><a href='#L352' title='Defined at 352.'>load_blacklist</a></li>
<li><a href='#L375' title='Defined at 375.'>write_config</a></li>
<li><a href='#L384' title='Defined at 384.'>fire</a></li>
<li><a href='#L425' title='Defined at 425.'>send_message</a></li>
<li><a href='#L432' title='Defined at 432.'>send_error</a></li>
<li><a href='#L454' title='Defined at 454.'>handle_request_campaign_list</a></li>
<li><a href='#L549' title='Defined at 549.'>handle_request_campaign</a></li>
<li><a href='#L580' title='Defined at 580.'>handle_request_terms</a></li>
<li><a href='#L606' title='Defined at 606.'>handle_upload</a></li>
<li><a href='#L780' title='Defined at 780.'>handle_delete</a></li>
<li><a href='#L832' title='Defined at 832.'>handle_change_passphrase</a></li>
<li><a href='#L859' title='Defined at 859.'>main</a></li>
</ol>
<hr />
<pre>
<a id='L1' name='L1'></a>   1 <em class='comment'>/*</em>
<a id='L2' name='L2'></a>   2 <em class='comment'>   Copyright (C) 2003 - 2017 by David White &lt;dave@whitevine.net&gt;</em>
<a id='L3' name='L3'></a>   3 <em class='comment'>   Part of the Battle for Wesnoth Project http://www.wesnoth.org/</em>
<a id='L4' name='L4'></a>   4 <em class='comment'></em>
<a id='L5' name='L5'></a>   5 <em class='comment'>   This program is free software; you can redistribute it and/or modify</em>
<a id='L6' name='L6'></a>   6 <em class='comment'>   it under the terms of the GNU General Public License as published by</em>
<a id='L7' name='L7'></a>   7 <em class='comment'>   the Free Software Foundation; either version 2 of the License, or</em>
<a id='L8' name='L8'></a>   8 <em class='comment'>   (at your option) any later version.</em>
<a id='L9' name='L9'></a>   9 <em class='comment'>   This program is distributed in the hope that it will be useful,</em>
<a id='L10' name='L10'></a>  10 <em class='comment'>   but WITHOUT ANY WARRANTY.</em>
<a id='L11' name='L11'></a>  11 <em class='comment'></em>
<a id='L12' name='L12'></a>  12 <em class='comment'>   See the COPYING file for more details.</em>
<a id='L13' name='L13'></a>  13 <em class='comment'>   */</em>
<a id='L14' name='L14'></a>  14 
<a id='L15' name='L15'></a>  15 <em class='comment'>/**</em>
<a id='L16' name='L16'></a>  16 <em class='comment'> * @file</em>
<a id='L17' name='L17'></a>  17 <em class='comment'> * Wesnoth addon server.</em>
<a id='L18' name='L18'></a>  18 <em class='comment'> * Expects a "server.cfg" config file in the current directory</em>
<a id='L19' name='L19'></a>  19 <em class='comment'> * and saves addons under data/.</em>
<a id='L20' name='L20'></a>  20 <em class='comment'> */</em>
<a id='L21' name='L21'></a>  21 
<a id='L22' name='L22'></a>  22 <em class='sharp'>#include</em> "<a href='922.html'>campaign_server/campaign_server.hpp</a>"
<a id='L23' name='L23'></a>  23 
<a id='L24' name='L24'></a>  24 <em class='sharp'>#include</em> "<a href='1257.html'>filesystem.hpp</a>"
<a id='L25' name='L25'></a>  25 <em class='sharp'>#include</em> "<a href='684.html'>lexical_cast.hpp</a>"
<a id='L26' name='L26'></a>  26 <em class='sharp'>#include</em> "<a href='../I/2029.html'>log.hpp</a>"
<a id='L27' name='L27'></a>  27 <em class='sharp'>#include</em> "<a href='121.html'>serialization/binary_or_text.hpp</a>"
<a id='L28' name='L28'></a>  28 <em class='sharp'>#include</em> "<a href='../I/2585.html'>serialization/parser.hpp</a>"
<a id='L29' name='L29'></a>  29 <em class='sharp'>#include</em> "<a href='../I/1909.html'>serialization/string_utils.hpp</a>"
<a id='L30' name='L30'></a>  30 <em class='sharp'>#include</em> "<a href='133.html'>serialization/unicode.hpp</a>"
<a id='L31' name='L31'></a>  31 <em class='sharp'>#include</em> "<a href='1112.html'>game_config.hpp</a>"
<a id='L32' name='L32'></a>  32 <em class='sharp'>#include</em> "<a href='222.html'>addon/validation.hpp</a>"
<a id='L33' name='L33'></a>  33 <em class='sharp'>#include</em> "<a href='917.html'>campaign_server/addon_utils.hpp</a>"
<a id='L34' name='L34'></a>  34 <em class='sharp'>#include</em> "<a href='919.html'>campaign_server/blacklist.hpp</a>"
<a id='L35' name='L35'></a>  35 <em class='sharp'>#include</em> "<a href='918.html'>campaign_server/control.hpp</a>"
<a id='L36' name='L36'></a>  36 <em class='sharp'>#include</em> "<a href='916.html'>campaign_server/fs_commit.hpp</a>"
<a id='L37' name='L37'></a>  37 <em class='sharp'>#include</em> "<a href='../I/1779.html'>version.hpp</a>"
<a id='L38' name='L38'></a>  38 <em class='sharp'>#include</em> "<a href='18.html'>hash.hpp</a>"
<a id='L39' name='L39'></a>  39 
<a id='L40' name='L40'></a>  40 <em class='sharp'>#include</em> &lt;csignal&gt;
<a id='L41' name='L41'></a>  41 <em class='sharp'>#include</em> &lt;ctime&gt;
<a id='L42' name='L42'></a>  42 
<a id='L43' name='L43'></a>  43 <em class='sharp'>#include</em> &lt;boost/iostreams/filter/gzip.hpp&gt;
<a id='L44' name='L44'></a>  44 <em class='sharp'>#include</em> &lt;boost/exception/get_error_info.hpp&gt;
<a id='L45' name='L45'></a>  45 <em class='sharp'>#include</em> &lt;<a href='821.html'>boost/random.hpp</a>&gt;
<a id='L46' name='L46'></a>  46 <em class='sharp'>#include</em> &lt;boost/generator_iterator.hpp&gt;
<a id='L47' name='L47'></a>  47 
<a id='L48' name='L48'></a>  48 <em class='comment'>// the fork execute is unix specific only tested on Linux quite sure it won't</em>
<a id='L49' name='L49'></a>  49 <em class='comment'>// work on Windows not sure which other platforms have a problem with it.</em>
<a id='L50' name='L50'></a>  50 <em class='sharp'>#if</em> !(<strong class='reserved'>defined</strong>(<a href='../Y/4851.html' title='Multiple used in 105 places.'>_WIN32</a>))
<a id='L51' name='L51'></a>  51 <em class='sharp'>#include</em> &lt;errno.h&gt;
<a id='L52' name='L52'></a>  52 <em class='sharp'>#endif</em>
<a id='L53' name='L53'></a>  53 
<a id='L54' name='L54'></a>  54 <strong class='reserved'>static</strong> <a href='../D/9809.html' title='Multiple defined in 5 places.'>lg</a>::<a href='../D/10019.html' title='Multiple defined in 2 places.'>log_domain</a> <a href='../Y/13481.html' title='Multiple used in 5 places.'>log_campaignd</a>("campaignd");
<a id='L55' name='L55'></a>  55 <em class='sharp'>#define</em> <a href='../R/241.html' title='Multiple referred from 2 places.'>DBG_CS</a> <a href='../S/660.html#L189' title='Defined at 189 in src/log.hpp.'>LOG_STREAM</a>(<a href='../D/5266.html' title='Multiple defined in 16 places.'>debug</a>, <a href='../Y/13481.html' title='Multiple used in 5 places.'>log_campaignd</a>)
<a id='L56' name='L56'></a>  56 <em class='sharp'>#define</em> <a href='../R/975.html' title='Multiple referred from 43 places.'>LOG_CS</a> <a href='../S/660.html#L189' title='Defined at 189 in src/log.hpp.'>LOG_STREAM</a>(<a href='../D/8860.html' title='Multiple defined in 2 places.'>info</a>,  <a href='../Y/13481.html' title='Multiple used in 5 places.'>log_campaignd</a>)
<a id='L57' name='L57'></a>  57 <em class='sharp'>#define</em> WRN_CS <a href='../S/660.html#L189' title='Defined at 189 in src/log.hpp.'>LOG_STREAM</a>(<a href='../S/847.html#L85' title='Defined at 85 in src/log.cpp.'>warn</a>,  <a href='../Y/13481.html' title='Multiple used in 5 places.'>log_campaignd</a>)
<a id='L58' name='L58'></a>  58 <em class='sharp'>#define</em> <a href='../R/394.html' title='Multiple referred from 14 places.'>ERR_CS</a> <a href='../S/660.html#L189' title='Defined at 189 in src/log.hpp.'>LOG_STREAM</a>(<a href='../S/847.html#L79' title='Defined at 79 in src/log.cpp.'>err</a>,   <a href='../Y/13481.html' title='Multiple used in 5 places.'>log_campaignd</a>)
<a id='L59' name='L59'></a>  59 
<a id='L60' name='L60'></a>  60 <strong class='reserved'>static</strong> <a href='../D/9809.html' title='Multiple defined in 5 places.'>lg</a>::<a href='../D/10019.html' title='Multiple defined in 2 places.'>log_domain</a> <a href='../Y/13484.html' title='Multiple used in 105 places.'>log_config</a>("config");
<a id='L61' name='L61'></a>  61 <em class='sharp'>#define</em> <a href='../R/393.html' title='Multiple referred from 10 places.'>ERR_CONFIG</a> <a href='../S/660.html#L189' title='Defined at 189 in src/log.hpp.'>LOG_STREAM</a>(<a href='../S/847.html#L79' title='Defined at 79 in src/log.cpp.'>err</a>, <a href='../Y/13484.html' title='Multiple used in 105 places.'>log_config</a>)
<a id='L62' name='L62'></a>  62 <em class='sharp'>#define</em> <a href='../R/2331.html' title='Multiple referred from 2 places.'>WRN_CONFIG</a> <a href='../S/660.html#L189' title='Defined at 189 in src/log.hpp.'>LOG_STREAM</a>(<a href='../S/847.html#L85' title='Defined at 85 in src/log.cpp.'>warn</a>, <a href='../Y/13484.html' title='Multiple used in 105 places.'>log_config</a>)
<a id='L63' name='L63'></a>  63 
<a id='L64' name='L64'></a>  64 <strong class='reserved'>static</strong> <a href='../D/9809.html' title='Multiple defined in 5 places.'>lg</a>::<a href='../D/10019.html' title='Multiple defined in 2 places.'>log_domain</a> <a href='../Y/13537.html' title='Multiple used in 21 places.'>log_server</a>("server");
<a id='L65' name='L65'></a>  65 <em class='sharp'>#define</em> <a href='../R/423.html' title='Multiple referred from 21 places.'>ERR_SERVER</a> <a href='../S/660.html#L189' title='Defined at 189 in src/log.hpp.'>LOG_STREAM</a>(<a href='../S/847.html#L79' title='Defined at 79 in src/log.cpp.'>err</a>, <a href='../Y/13537.html' title='Multiple used in 21 places.'>log_server</a>)
<a id='L66' name='L66'></a>  66 
<a id='L67' name='L67'></a>  67 <em class='sharp'>#include</em> "server/send_receive_wml_helpers.ipp"
<a id='L68' name='L68'></a>  68 
<a id='L69' name='L69'></a>  69 <strong class='reserved'>namespace</strong> <em class='brace'>{</em>
<a id='L70' name='L70'></a>  70 
<a id='L71' name='L71'></a>  71 <em class='comment'>/* Secure password storage functions */</em>
<a id='L72' name='L72'></a>  72 <strong class='reserved'>bool</strong> <a href='../R/3134.html' title='Multiple referred from 10 places.'>authenticate</a>(<a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>, <strong class='reserved'>const</strong> <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>::<a href='../S/1105.html#L245' title='Defined at 245 in src/config.hpp.'>attribute_value</a>&amp; <a href='../Y/16281.html' title='Multiple used in 12 places.'>passphrase</a>)
<a id='L73' name='L73'></a>  73 <em class='brace'>{</em>
<a id='L74' name='L74'></a>  74         <strong class='reserved'>return</strong> <a href='../D/15924.html' title='Multiple defined in 17 places.'>utils</a>::<a href='../D/10937.html' title='Multiple defined in 3 places.'>md5</a>(<a href='../Y/16281.html' title='Multiple used in 12 places.'>passphrase</a>, <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["passsalt"]).<a href='../D/8568.html' title='Multiple defined in 2 places.'>hex_digest</a>() == <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["passhash"];
<a id='L75' name='L75'></a>  75 <em class='brace'>}</em>
<a id='L76' name='L76'></a>  76 
<a id='L77' name='L77'></a>  77 <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a> <a href='../S/921.html#L94' title='Referred from 94 in src/campaign_server/campaign_server.cpp.'>generate_salt</a>(<a href='../Y/18861.html' title='Multiple used in 1749 places.'>size_t</a> <a href='../Y/13153.html' title='Multiple used in 361 places.'>len</a>)
<a id='L78' name='L78'></a>  78 <em class='brace'>{</em>
<a id='L79' name='L79'></a>  79         <strong class='reserved'>static</strong> <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a> <a href='../Y/12604.html' title='Multiple used in 9 places.'>itoa64</a> = "./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
<a id='L80' name='L80'></a>  80         <a href='../D/3739.html' title='Multiple defined in 4 places.'>boost</a>::<a href='../Y/14597.html' title='Multiple used in 14 places.'>mt19937</a> <a href='../Y/14596.html' title='Multiple used in 71 places.'>mt</a>(<a href='../D/15224.html' title='Multiple defined in 4 places.'>time</a>(0));
<a id='L81' name='L81'></a>  81         <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a> <a href='../Y/17961.html' title='Multiple used in 16 places.'>salt</a> = <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>(<a href='../Y/13153.html' title='Multiple used in 361 places.'>len</a>, '0');
<a id='L82' name='L82'></a>  82         <a href='../D/3739.html' title='Multiple defined in 4 places.'>boost</a>::<a href='../Y/21088.html' title='Multiple used in 2 places.'>uniform_int</a>&lt;&gt; <a href='../Y/10534.html' title='Multiple used in 2 places.'>from_str</a>(0, <a href='../Y/12604.html' title='Multiple used in 9 places.'>itoa64</a>.<a href='../S/136.html#L123' title='Defined at 123 in src/serialization/string_view.hpp.'>length</a>() - 1);
<a id='L83' name='L83'></a>  83         <a href='../D/3739.html' title='Multiple defined in 4 places.'>boost</a>::variate_generator&lt; <a href='../D/3739.html' title='Multiple defined in 4 places.'>boost</a>::<a href='../Y/14597.html' title='Multiple used in 14 places.'>mt19937</a>, <a href='../D/3739.html' title='Multiple defined in 4 places.'>boost</a>::<a href='../Y/21088.html' title='Multiple used in 2 places.'>uniform_int</a>&lt;&gt; &gt; <a href='../Y/10961.html' title='Multiple used in 2 places.'>get_char</a>(<a href='../Y/14596.html' title='Multiple used in 71 places.'>mt</a>, <a href='../Y/10534.html' title='Multiple used in 2 places.'>from_str</a>);
<a id='L84' name='L84'></a>  84 
<a id='L85' name='L85'></a>  85         <strong class='reserved'>for</strong>(<a href='../Y/18861.html' title='Multiple used in 1749 places.'>size_t</a> <a href='../D/8660.html' title='Multiple defined in 5 places.'>i</a> = 0; <a href='../D/8660.html' title='Multiple defined in 5 places.'>i</a> &lt; <a href='../Y/13153.html' title='Multiple used in 361 places.'>len</a>; <a href='../D/8660.html' title='Multiple defined in 5 places.'>i</a>++) <em class='brace'>{</em>
<a id='L86' name='L86'></a>  86                 <a href='../Y/17961.html' title='Multiple used in 16 places.'>salt</a>[<a href='../D/8660.html' title='Multiple defined in 5 places.'>i</a>] = <a href='../Y/12604.html' title='Multiple used in 9 places.'>itoa64</a>[<a href='../Y/10961.html' title='Multiple used in 2 places.'>get_char</a>()];
<a id='L87' name='L87'></a>  87         <em class='brace'>}</em>
<a id='L88' name='L88'></a>  88 
<a id='L89' name='L89'></a>  89         <strong class='reserved'>return</strong> <a href='../Y/17961.html' title='Multiple used in 16 places.'>salt</a>;
<a id='L90' name='L90'></a>  90 <em class='brace'>}</em>
<a id='L91' name='L91'></a>  91 
<a id='L92' name='L92'></a>  92 <strong class='reserved'>void</strong> <a href='../R/12847.html' title='Multiple referred from 4 places.'>set_passphrase</a>(<a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>, <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a> <a href='../Y/16281.html' title='Multiple used in 12 places.'>passphrase</a>)
<a id='L93' name='L93'></a>  93 <em class='brace'>{</em>
<a id='L94' name='L94'></a>  94         <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a> <a href='../Y/17961.html' title='Multiple used in 16 places.'>salt</a> = <a href='../S/921.html#L77' title='Defined at 77 in src/campaign_server/campaign_server.cpp.'>generate_salt</a>(16);
<a id='L95' name='L95'></a>  95         <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["passsalt"] = <a href='../Y/17961.html' title='Multiple used in 16 places.'>salt</a>;
<a id='L96' name='L96'></a>  96         <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["passhash"] = <a href='../D/15924.html' title='Multiple defined in 17 places.'>utils</a>::<a href='../D/10937.html' title='Multiple defined in 3 places.'>md5</a>(<a href='../Y/16281.html' title='Multiple used in 12 places.'>passphrase</a>, <a href='../Y/17961.html' title='Multiple used in 16 places.'>salt</a>).<a href='../D/8568.html' title='Multiple defined in 2 places.'>hex_digest</a>();
<a id='L97' name='L97'></a>  97 <em class='brace'>}</em>
<a id='L98' name='L98'></a>  98 
<a id='L99' name='L99'></a>  99 <em class='brace'>}</em> <em class='comment'>// end anonymous namespace</em>
<a id='L100' name='L100'></a> 100 
<a id='L101' name='L101'></a> 101 <strong class='reserved'>namespace</strong> <a href='../S/921.html#L872' title='Referred from 872 in src/campaign_server/campaign_server.cpp.'>campaignd</a> <em class='brace'>{</em>
<a id='L102' name='L102'></a> 102 
<a id='L103' name='L103'></a> 103 <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>(<strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../Y/7192.html' title='Multiple used in 3 places.'>cfg_file</a>)
<a id='L104' name='L104'></a> 104         : <a href='../S/151.html#L40' title='Defined at 40 in src/server/server_base.hpp.'>server_base</a>(<a href='../Y/8502.html' title='Multiple used in 5 places.'>default_campaignd_port</a>, <strong class='reserved'>true</strong>)
<a id='L105' name='L105'></a> 105         , <a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>()
<a id='L106' name='L106'></a> 106         , <a href='../Y/7193.html' title='Multiple used in 5 places.'>cfg_file_</a>(<a href='../Y/7192.html' title='Multiple used in 3 places.'>cfg_file</a>)
<a id='L107' name='L107'></a> 107         , <a href='../Y/17145.html' title='Multiple used in 16 places.'>read_only_</a>(<strong class='reserved'>false</strong>)
<a id='L108' name='L108'></a> 108         , <a href='../Y/7773.html' title='Multiple used in 5 places.'>compress_level_</a>(0)
<a id='L109' name='L109'></a> 109         , <a href='../Y/11682.html' title='Multiple used in 6 places.'>hooks_</a>()
<a id='L110' name='L110'></a> 110         , <a href='../Y/11337.html' title='Multiple used in 7 places.'>handlers_</a>()
<a id='L111' name='L111'></a> 111         , <a href='../Y/9966.html' title='Multiple used in 5 places.'>feedback_url_format_</a>()
<a id='L112' name='L112'></a> 112         , <a href='../Y/6526.html' title='Multiple used in 5 places.'>blacklist_</a>()
<a id='L113' name='L113'></a> 113         , <a href='../Y/6527.html' title='Multiple used in 7 places.'>blacklist_file_</a>()
<a id='L114' name='L114'></a> 114         , <a href='../R/5719.html' title='Multiple referred from 3 places.'>flush_timer_</a>(<a href='../Y/12312.html' title='Multiple used in 29 places.'>io_service_</a>)
<a id='L115' name='L115'></a> 115 <em class='brace'>{</em>
<a id='L116' name='L116'></a> 116 
<a id='L117' name='L117'></a> 117 <em class='sharp'>#ifndef</em> <a href='../Y/4851.html' title='Multiple used in 105 places.'>_WIN32</a>
<a id='L118' name='L118'></a> 118         <strong class='reserved'>struct</strong> <a href='../Y/18771.html' title='Multiple used in 6 places.'>sigaction</a> <a href='../Y/17951.html' title='Multiple used in 40 places.'>sa</a>;
<a id='L119' name='L119'></a> 119         <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/14115.html' title='Multiple used in 6 places.'>memset</a>( &amp;<a href='../Y/17951.html' title='Multiple used in 40 places.'>sa</a>, 0, <strong class='reserved'>sizeof</strong>(<a href='../Y/17951.html' title='Multiple used in 40 places.'>sa</a>) );
<a id='L120' name='L120'></a> 120 <em class='sharp'>        #pragma</em> GCC diagnostic ignored "-Wold-style-cast"
<a id='L121' name='L121'></a> 121         <a href='../Y/17951.html' title='Multiple used in 40 places.'>sa</a>.<a href='../Y/17954.html' title='Multiple used in 3 places.'>sa_handler</a> = <a href='../Y/2780.html' title='Multiple used in 2 places.'>SIG_IGN</a>;
<a id='L122' name='L122'></a> 122         <strong class='reserved'>int</strong> <a href='../Y/17594.html' title='Multiple used in 1907 places.'>res</a> = <a href='../Y/18771.html' title='Multiple used in 6 places.'>sigaction</a>( SIGPIPE, &amp;<a href='../Y/17951.html' title='Multiple used in 40 places.'>sa</a>, <a href='../Y/15374.html' title='Multiple used in 2007 places.'>nullptr</a>);
<a id='L123' name='L123'></a> 123         <a href='../Y/5879.html' title='Multiple used in 1200 places.'>assert</a>( <a href='../Y/17594.html' title='Multiple used in 1907 places.'>res</a> == 0 );
<a id='L124' name='L124'></a> 124 <em class='sharp'>#endif</em>
<a id='L125' name='L125'></a> 125 
<a id='L126' name='L126'></a> 126         <a href='../D/9909.html' title='Multiple defined in 5 places.'>load_config</a>();
<a id='L127' name='L127'></a> 127 
<a id='L128' name='L128'></a> 128         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Port: " &lt;&lt; <a href='../Y/16549.html' title='Multiple used in 10 places.'>port_</a> &lt;&lt; "\n";
<a id='L129' name='L129'></a> 129 
<a id='L130' name='L130'></a> 130         <em class='comment'>// Ensure all campaigns to use secure hash passphrase storage</em>
<a id='L131' name='L131'></a> 131         <strong class='reserved'>if</strong>(!<a href='../Y/17145.html' title='Multiple used in 16 places.'>read_only_</a>) <em class='brace'>{</em>
<a id='L132' name='L132'></a> 132                 <strong class='reserved'>for</strong>(<a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a> : <a href='../D/4086.html' title='Multiple defined in 2 places.'>campaigns</a>().<a href='../D/4431.html' title='Multiple defined in 2 places.'>child_range</a>("campaign")) <em class='brace'>{</em>
<a id='L133' name='L133'></a> 133                         <em class='comment'>// Campaign already has a hashed password</em>
<a id='L134' name='L134'></a> 134                         <strong class='reserved'>if</strong>(<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["passphrase"].<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()) <em class='brace'>{</em>
<a id='L135' name='L135'></a> 135                                 <strong class='reserved'>continue</strong>;
<a id='L136' name='L136'></a> 136                         <em class='brace'>}</em>
<a id='L137' name='L137'></a> 137 
<a id='L138' name='L138'></a> 138                         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Campaign '" &lt;&lt; <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["title"] &lt;&lt; "' uses unhashed passphrase. Fixing.\n";
<a id='L139' name='L139'></a> 139                         <a href='../S/921.html#L92' title='Defined at 92 in src/campaign_server/campaign_server.cpp.'>set_passphrase</a>(<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>, <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["passphrase"]);
<a id='L140' name='L140'></a> 140                         <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["passphrase"] = "";
<a id='L141' name='L141'></a> 141                 <em class='brace'>}</em>
<a id='L142' name='L142'></a> 142                 <a href='../D/16579.html' title='Multiple defined in 4 places.'>write_config</a>();
<a id='L143' name='L143'></a> 143         <em class='brace'>}</em>
<a id='L144' name='L144'></a> 144 
<a id='L145' name='L145'></a> 145         <a href='../Y/17396.html' title='Multiple used in 3 places.'>register_handlers</a>();
<a id='L146' name='L146'></a> 146 
<a id='L147' name='L147'></a> 147         <a href='../S/166.html#L46' title='Defined at 46 in src/server/server_base.cpp.'>start_server</a>();
<a id='L148' name='L148'></a> 148         <a href='../S/921.html#L336' title='Defined at 336 in src/campaign_server/campaign_server.cpp.'>flush_cfg</a>();
<a id='L149' name='L149'></a> 149 <em class='brace'>}</em>
<a id='L150' name='L150'></a> 150 
<a id='L151' name='L151'></a> 151 <a href='../R/12389.html' title='Multiple referred from 225 places.'>server</a>::~<a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>()
<a id='L152' name='L152'></a> 152 <em class='brace'>{</em>
<a id='L153' name='L153'></a> 153         <a href='../D/16579.html' title='Multiple defined in 4 places.'>write_config</a>();
<a id='L154' name='L154'></a> 154 <em class='brace'>}</em>
<a id='L155' name='L155'></a> 155 
<a id='L156' name='L156'></a> 156 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../R/8980.html' title='Multiple referred from 24 places.'>load_config</a>()
<a id='L157' name='L157'></a> 157 <em class='brace'>{</em>
<a id='L158' name='L158'></a> 158         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Reading configuration from " &lt;&lt; <a href='../Y/7193.html' title='Multiple used in 5 places.'>cfg_file_</a> &lt;&lt; "...\n";
<a id='L159' name='L159'></a> 159 
<a id='L160' name='L160'></a> 160         <a href='../D/6226.html' title='Multiple defined in 6 places.'>filesystem</a>::<a href='../S/1257.html#L37' title='Defined at 37 in src/filesystem.hpp.'>scoped_istream</a> <a href='../D/8823.html' title='Multiple defined in 4 places.'>in</a> = <a href='../D/6226.html' title='Multiple defined in 6 places.'>filesystem</a>::<a href='../S/314.html#L764' title='Defined at 764 in src/filesystem_boost.cpp.'>istream_file</a>(<a href='../Y/7193.html' title='Multiple used in 5 places.'>cfg_file_</a>);
<a id='L161' name='L161'></a> 161         <a href='../D/12406.html' title='Multiple defined in 23 places.'>read</a>(<a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>, *<a href='../D/8823.html' title='Multiple defined in 4 places.'>in</a>);
<a id='L162' name='L162'></a> 162 
<a id='L163' name='L163'></a> 163         <a href='../Y/17145.html' title='Multiple used in 16 places.'>read_only_</a> = <a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>["read_only"].<a href='../D/15259.html' title='Multiple defined in 2 places.'>to_bool</a>(<strong class='reserved'>false</strong>);
<a id='L164' name='L164'></a> 164 
<a id='L165' name='L165'></a> 165         <strong class='reserved'>if</strong>(<a href='../Y/17145.html' title='Multiple used in 16 places.'>read_only_</a>) <em class='brace'>{</em>
<a id='L166' name='L166'></a> 166                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "READ-ONLY MODE ACTIVE\n";
<a id='L167' name='L167'></a> 167         <em class='brace'>}</em>
<a id='L168' name='L168'></a> 168 
<a id='L169' name='L169'></a> 169         <em class='comment'>// Seems like compression level above 6 is a waste of CPU cycles.</em>
<a id='L170' name='L170'></a> 170         <a href='../Y/7773.html' title='Multiple used in 5 places.'>compress_level_</a> = <a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>["compress_level"].<a href='../D/15269.html' title='Multiple defined in 2 places.'>to_int</a>(6);
<a id='L171' name='L171'></a> 171 
<a id='L172' name='L172'></a> 172         <strong class='reserved'>const</strong> <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../Y/19568.html' title='Multiple used in 3 places.'>svinfo_cfg</a> = <a href='../D/13528.html' title='Multiple defined in 3 places.'>server_info</a>();
<a id='L173' name='L173'></a> 173         <strong class='reserved'>if</strong>(<a href='../Y/19568.html' title='Multiple used in 3 places.'>svinfo_cfg</a>) <em class='brace'>{</em>
<a id='L174' name='L174'></a> 174                 <a href='../Y/9966.html' title='Multiple used in 5 places.'>feedback_url_format_</a> = <a href='../Y/19568.html' title='Multiple used in 3 places.'>svinfo_cfg</a>["feedback_url_format"].<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>();
<a id='L175' name='L175'></a> 175         <em class='brace'>}</em>
<a id='L176' name='L176'></a> 176 
<a id='L177' name='L177'></a> 177         <a href='../Y/6527.html' title='Multiple used in 7 places.'>blacklist_file_</a> = <a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>["blacklist_file"].<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>();
<a id='L178' name='L178'></a> 178         <a href='../S/921.html#L352' title='Defined at 352 in src/campaign_server/campaign_server.cpp.'>load_blacklist</a>();
<a id='L179' name='L179'></a> 179 
<a id='L180' name='L180'></a> 180         <em class='comment'>// Load any configured hooks.</em>
<a id='L181' name='L181'></a> 181         <a href='../Y/11682.html' title='Multiple used in 6 places.'>hooks_</a>.<a href='../Y/9317.html' title='Multiple used in 339 places.'>emplace</a>(<a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>("hook_post_upload"), <a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>["hook_post_upload"]);
<a id='L182' name='L182'></a> 182         <a href='../Y/11682.html' title='Multiple used in 6 places.'>hooks_</a>.<a href='../Y/9317.html' title='Multiple used in 339 places.'>emplace</a>(<a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>("hook_post_erase"), <a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>["hook_post_erase"]);
<a id='L183' name='L183'></a> 183 
<a id='L184' name='L184'></a> 184 <em class='sharp'>#ifndef</em> <a href='../Y/4851.html' title='Multiple used in 105 places.'>_WIN32</a>
<a id='L185' name='L185'></a> 185         <em class='comment'>// Open the control socket if enabled.</em>
<a id='L186' name='L186'></a> 186         <strong class='reserved'>if</strong>(!<a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>["control_socket"].<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()) <em class='brace'>{</em>
<a id='L187' name='L187'></a> 187                 <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../D/11848.html' title='Multiple defined in 6 places.'>path</a> = <a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>["control_socket"].<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>();
<a id='L188' name='L188'></a> 188 
<a id='L189' name='L189'></a> 189                 <strong class='reserved'>if</strong>(<a href='../D/11848.html' title='Multiple defined in 6 places.'>path</a> != <a href='../Y/10005.html' title='Multiple used in 3 places.'>fifo_path_</a>) <em class='brace'>{</em>
<a id='L190' name='L190'></a> 190                         <strong class='reserved'>const</strong> <strong class='reserved'>int</strong> <a href='../Y/17594.html' title='Multiple used in 1907 places.'>res</a> = <a href='../Y/14338.html' title='Multiple used in 2 places.'>mkfifo</a>(<a href='../D/11848.html' title='Multiple defined in 6 places.'>path</a>.<a href='../D/3892.html' title='Multiple defined in 2 places.'>c_str</a>(),0660);
<a id='L191' name='L191'></a> 191                         <strong class='reserved'>if</strong>(<a href='../Y/17594.html' title='Multiple used in 1907 places.'>res</a> != 0 &amp;&amp; <a href='../Y/9614.html' title='Multiple used in 17 places.'>errno</a> != <a href='../Y/675.html' title='Multiple used in 2 places.'>EEXIST</a>) <em class='brace'>{</em>
<a id='L192' name='L192'></a> 192                                 <a href='../S/921.html#L58' title='Defined at 58 in src/campaign_server/campaign_server.cpp.'>ERR_CS</a> &lt;&lt; "could not make fifo at '" &lt;&lt; <a href='../D/11848.html' title='Multiple defined in 6 places.'>path</a> &lt;&lt; "' (" &lt;&lt; <a href='../Y/19390.html' title='Multiple used in 13 places.'>strerror</a>(<a href='../Y/9614.html' title='Multiple used in 17 places.'>errno</a>) &lt;&lt; ")\n";
<a id='L193' name='L193'></a> 193                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L194' name='L194'></a> 194                                 <a href='../S/1018.html#L33' title='Defined at 33 in src/units/frame_private.hpp.'>input_</a>.<a href='../D/4575.html' title='Multiple defined in 5 places.'>close</a>();
<a id='L195' name='L195'></a> 195                                 <strong class='reserved'>int</strong> <a href='../Y/10003.html' title='Multiple used in 4 places.'>fifo</a> = <a href='../D/11609.html' title='Multiple defined in 3 places.'>open</a>(<a href='../D/11848.html' title='Multiple defined in 6 places.'>path</a>.<a href='../D/3892.html' title='Multiple defined in 2 places.'>c_str</a>(), <a href='../Y/2100.html' title='Multiple used in 2 places.'>O_RDWR</a>|<a href='../Y/2099.html' title='Multiple used in 3 places.'>O_NONBLOCK</a>);
<a id='L196' name='L196'></a> 196                                 <a href='../S/1018.html#L33' title='Defined at 33 in src/units/frame_private.hpp.'>input_</a>.<a href='../D/3433.html' title='Multiple defined in 3 places.'>assign</a>(<a href='../Y/10003.html' title='Multiple used in 4 places.'>fifo</a>);
<a id='L197' name='L197'></a> 197                                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "opened fifo at '" &lt;&lt; <a href='../D/11848.html' title='Multiple defined in 6 places.'>path</a> &lt;&lt; "'. Server commands may be written to this file.\n";
<a id='L198' name='L198'></a> 198                                 <a href='../S/166.html#L126' title='Defined at 126 in src/server/server_base.cpp.'>read_from_fifo</a>();
<a id='L199' name='L199'></a> 199                                 <a href='../Y/10005.html' title='Multiple used in 3 places.'>fifo_path_</a> = <a href='../D/11848.html' title='Multiple defined in 6 places.'>path</a>;
<a id='L200' name='L200'></a> 200                         <em class='brace'>}</em>
<a id='L201' name='L201'></a> 201                 <em class='brace'>}</em>
<a id='L202' name='L202'></a> 202         <em class='brace'>}</em>
<a id='L203' name='L203'></a> 203 <em class='sharp'>#endif</em>
<a id='L204' name='L204'></a> 204 
<a id='L205' name='L205'></a> 205         <em class='comment'>// Ensure the campaigns list WML exists even if empty, other functions</em>
<a id='L206' name='L206'></a> 206         <em class='comment'>// depend on its existence.</em>
<a id='L207' name='L207'></a> 207         <a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>.<a href='../S/680.html#L398' title='Defined at 398 in src/config.cpp.'>child_or_add</a>("campaigns");
<a id='L208' name='L208'></a> 208 
<a id='L209' name='L209'></a> 209         <em class='comment'>// Certain config values are saved to WML again so that a given server</em>
<a id='L210' name='L210'></a> 210         <em class='comment'>// instance's parameters remain constant even if the code defaults change</em>
<a id='L211' name='L211'></a> 211         <em class='comment'>// at some later point.</em>
<a id='L212' name='L212'></a> 212         <a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>["compress_level"] = <a href='../Y/7773.html' title='Multiple used in 5 places.'>compress_level_</a>;
<a id='L213' name='L213'></a> 213 
<a id='L214' name='L214'></a> 214         <em class='comment'>// But not the listening port number.</em>
<a id='L215' name='L215'></a> 215         <a href='../Y/16549.html' title='Multiple used in 10 places.'>port_</a> = <a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>["port"].<a href='../D/15269.html' title='Multiple defined in 2 places.'>to_int</a>(<a href='../Y/8502.html' title='Multiple used in 5 places.'>default_campaignd_port</a>);
<a id='L216' name='L216'></a> 216 
<a id='L217' name='L217'></a> 217         <em class='comment'>// Limit the max size of WML documents received from the net to prevent the</em>
<a id='L218' name='L218'></a> 218         <em class='comment'>// possible excessive use of resources due to malformed packets received.</em>
<a id='L219' name='L219'></a> 219         <em class='comment'>// Since an addon is sent in a single WML document this essentially limits</em>
<a id='L220' name='L220'></a> 220         <em class='comment'>// the maximum size of an addon that can be uploaded.</em>
<a id='L221' name='L221'></a> 221         <a href='../D/14558.html' title='Multiple defined in 2 places.'>simple_wml</a>::<a href='../D/5662.html' title='Multiple defined in 2 places.'>document</a>::<a href='../Y/9024.html' title='Multiple used in 4 places.'>document_size_limit</a> = <a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>["document_size_limit"].<a href='../D/15269.html' title='Multiple defined in 2 places.'>to_int</a>(<a href='../Y/8515.html' title='Multiple used in 2 places.'>default_document_size_limit</a>);
<a id='L222' name='L222'></a> 222 <em class='brace'>}</em>
<a id='L223' name='L223'></a> 223 
<a id='L224' name='L224'></a> 224 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../R/7540.html' title='Multiple referred from 8 places.'>handle_new_client</a>(<a href='../S/151.html#L33' title='Defined at 33 in src/server/server_base.hpp.'>socket_ptr</a> <a href='../D/14621.html' title='Multiple defined in 3 places.'>socket</a>)
<a id='L225' name='L225'></a> 225 <em class='brace'>{</em>
<a id='L226' name='L226'></a> 226         <a href='../Y/5899.html' title='Multiple used in 4 places.'>async_receive_doc</a>(<a href='../D/14621.html' title='Multiple defined in 3 places.'>socket</a>,
<a id='L227' name='L227'></a> 227                                           <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/3645.html' title='Multiple defined in 3 places.'>bind</a>(&amp;<a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../S/921.html#L231' title='Defined at 231 in src/campaign_server/campaign_server.cpp.'>handle_request</a>, <strong class='reserved'>this</strong>, <a href='../Y/4797.html' title='Multiple used in 111 places.'>_1</a>, <a href='../Y/4798.html' title='Multiple used in 131 places.'>_2</a>)
<a id='L228' name='L228'></a> 228                                           );
<a id='L229' name='L229'></a> 229 <em class='brace'>}</em>
<a id='L230' name='L230'></a> 230 
<a id='L231' name='L231'></a> 231 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../R/7555.html' title='Multiple referred from 2 places.'>handle_request</a>(<a href='../S/151.html#L33' title='Defined at 33 in src/server/server_base.hpp.'>socket_ptr</a> <a href='../D/14621.html' title='Multiple defined in 3 places.'>socket</a>, <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/18613.html' title='Multiple used in 436 places.'>shared_ptr</a>&lt;<a href='../D/14558.html' title='Multiple defined in 2 places.'>simple_wml</a>::<a href='../D/5662.html' title='Multiple defined in 2 places.'>document</a>&gt; <a href='../Y/9007.html' title='Multiple used in 150 places.'>doc</a>)
<a id='L232' name='L232'></a> 232 <em class='brace'>{</em>
<a id='L233' name='L233'></a> 233         <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a> <a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>;
<a id='L234' name='L234'></a> 234         <a href='../D/12406.html' title='Multiple defined in 23 places.'>read</a>(<a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>, <a href='../Y/9007.html' title='Multiple used in 150 places.'>doc</a>-&gt;<a href='../D/11680.html' title='Multiple defined in 5 places.'>output</a>());
<a id='L235' name='L235'></a> 235 
<a id='L236' name='L236'></a> 236         <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>::<a href='../D/3238.html' title='Multiple defined in 2 places.'>all_children_iterator</a> <a href='../D/8660.html' title='Multiple defined in 5 places.'>i</a> = <a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>.<a href='../D/11653.html' title='Multiple defined in 3 places.'>ordered_begin</a>();
<a id='L237' name='L237'></a> 237 
<a id='L238' name='L238'></a> 238         <strong class='reserved'>if</strong>(<a href='../D/8660.html' title='Multiple defined in 5 places.'>i</a> != <a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>.<a href='../D/11657.html' title='Multiple defined in 3 places.'>ordered_end</a>()) <em class='brace'>{</em>
<a id='L239' name='L239'></a> 239                 <em class='comment'>// We only handle the first child.</em>
<a id='L240' name='L240'></a> 240                 <strong class='reserved'>const</strong> <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>::<a href='../S/1105.html#L545' title='Defined at 545 in src/config.hpp.'>any_child</a>&amp; <a href='../D/3888.html' title='Multiple defined in 2 places.'>c</a> = *<a href='../D/8660.html' title='Multiple defined in 5 places.'>i</a>;
<a id='L241' name='L241'></a> 241 
<a id='L242' name='L242'></a> 242                 <a href='../S/922.html#L79' title='Defined at 79 in src/campaign_server/campaign_server.hpp.'>request_handlers_table</a>::<a href='../D/4857.html' title='Multiple defined in 13 places.'>const_iterator</a> <a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a>
<a id='L243' name='L243'></a> 243                                 = <a href='../Y/11337.html' title='Multiple used in 7 places.'>handlers_</a>.<a href='../D/6279.html' title='Multiple defined in 39 places.'>find</a>(<a href='../D/3888.html' title='Multiple defined in 2 places.'>c</a>.<a href='../D/9617.html' title='Multiple defined in 4 places.'>key</a>);
<a id='L244' name='L244'></a> 244 
<a id='L245' name='L245'></a> 245                 <strong class='reserved'>if</strong>(<a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a> != <a href='../Y/11337.html' title='Multiple used in 7 places.'>handlers_</a>.<a href='../D/5899.html' title='Multiple defined in 28 places.'>end</a>()) <em class='brace'>{</em>
<a id='L246' name='L246'></a> 246                         <em class='comment'>// Call the handler.</em>
<a id='L247' name='L247'></a> 247                         <a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a>-&gt;<a href='../Y/18207.html' title='Multiple used in 1330 places.'>second</a>(<strong class='reserved'>this</strong>, <a href='../D/12850.html' title='Multiple defined in 3 places.'>request</a>(<a href='../D/3888.html' title='Multiple defined in 2 places.'>c</a>.<a href='../D/9617.html' title='Multiple defined in 4 places.'>key</a>, <a href='../D/3888.html' title='Multiple defined in 2 places.'>c</a>.<a href='../D/4196.html' title='Multiple defined in 5 places.'>cfg</a>, <a href='../D/14621.html' title='Multiple defined in 3 places.'>socket</a>));
<a id='L248' name='L248'></a> 248                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L249' name='L249'></a> 249                         <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Unrecognized [" + <a href='../D/3888.html' title='Multiple defined in 2 places.'>c</a>.<a href='../D/9617.html' title='Multiple defined in 4 places.'>key</a> + "] request.",<a href='../D/14621.html' title='Multiple defined in 3 places.'>socket</a>);
<a id='L250' name='L250'></a> 250                 <em class='brace'>}</em>
<a id='L251' name='L251'></a> 251         <em class='brace'>}</em>
<a id='L252' name='L252'></a> 252 <em class='brace'>}</em>
<a id='L253' name='L253'></a> 253 
<a id='L254' name='L254'></a> 254 <em class='sharp'>#ifndef</em> <a href='../Y/4851.html' title='Multiple used in 105 places.'>_WIN32</a>
<a id='L255' name='L255'></a> 255 
<a id='L256' name='L256'></a> 256 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../R/7551.html' title='Multiple referred from 4 places.'>handle_read_from_fifo</a>(<strong class='reserved'>const</strong> <a href='../D/3739.html' title='Multiple defined in 4 places.'>boost</a>::<a href='../Y/19618.html' title='Multiple used in 72 places.'>system</a>::<a href='../Y/9622.html' title='Multiple used in 102 places.'>error_code</a>&amp; <a href='../D/5980.html' title='Multiple defined in 22 places.'>error</a>, <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/18861.html' title='Multiple used in 1749 places.'>size_t</a>)
<a id='L257' name='L257'></a> 257 <em class='brace'>{</em>
<a id='L258' name='L258'></a> 258         <strong class='reserved'>if</strong>(<a href='../D/5980.html' title='Multiple defined in 22 places.'>error</a>) <em class='brace'>{</em>
<a id='L259' name='L259'></a> 259                 <strong class='reserved'>if</strong>(<a href='../D/5980.html' title='Multiple defined in 22 places.'>error</a> == <a href='../D/3739.html' title='Multiple defined in 4 places.'>boost</a>::<a href='../Y/5856.html' title='Multiple used in 52 places.'>asio</a>::<a href='../D/5980.html' title='Multiple defined in 22 places.'>error</a>::<a href='../Y/15767.html' title='Multiple used in 3 places.'>operation_aborted</a>)
<a id='L260' name='L260'></a> 260                         <em class='comment'>// This means fifo was closed by load_config() to open another fifo</em>
<a id='L261' name='L261'></a> 261                         <strong class='reserved'>return</strong>;
<a id='L262' name='L262'></a> 262                 <a href='../S/921.html#L58' title='Defined at 58 in src/campaign_server/campaign_server.cpp.'>ERR_CS</a> &lt;&lt; "Error reading from fifo: " &lt;&lt; <a href='../D/5980.html' title='Multiple defined in 22 places.'>error</a>.<a href='../D/10972.html' title='Multiple defined in 7 places.'>message</a>() &lt;&lt; '\n';
<a id='L263' name='L263'></a> 263                 <strong class='reserved'>return</strong>;
<a id='L264' name='L264'></a> 264         <em class='brace'>}</em>
<a id='L265' name='L265'></a> 265 
<a id='L266' name='L266'></a> 266         <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/12519.html' title='Multiple used in 37 places.'>istream</a> <a href='../Y/12331.html' title='Multiple used in 28 places.'>is</a>(&amp;<a href='../Y/5399.html' title='Multiple used in 4 places.'>admin_cmd_</a>);
<a id='L267' name='L267'></a> 267         <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a> <a href='../S/918.html#L70' title='Defined at 70 in src/campaign_server/control.hpp.'>cmd</a>;
<a id='L268' name='L268'></a> 268         <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/11045.html' title='Multiple used in 5 places.'>getline</a>(<a href='../Y/12331.html' title='Multiple used in 28 places.'>is</a>, <a href='../S/918.html#L70' title='Defined at 70 in src/campaign_server/control.hpp.'>cmd</a>);
<a id='L269' name='L269'></a> 269 
<a id='L270' name='L270'></a> 270         <strong class='reserved'>const</strong> <a href='../S/918.html#L32' title='Defined at 32 in src/campaign_server/control.hpp.'>control_line</a> <a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a> = <a href='../S/918.html#L70' title='Defined at 70 in src/campaign_server/control.hpp.'>cmd</a>;
<a id='L271' name='L271'></a> 271 
<a id='L272' name='L272'></a> 272         <strong class='reserved'>if</strong>(<a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a> == "shut_down") <em class='brace'>{</em>
<a id='L273' name='L273'></a> 273                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Shut down requested by admin, shutting down...\n";
<a id='L274' name='L274'></a> 274                 <strong class='reserved'>throw</strong> <a href='../S/151.html#L35' title='Defined at 35 in src/server/server_base.hpp.'>server_shutdown</a>("Shut down via fifo command");
<a id='L275' name='L275'></a> 275         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a> == "readonly") <em class='brace'>{</em>
<a id='L276' name='L276'></a> 276                 <strong class='reserved'>if</strong>(<a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a>.<a href='../S/918.html#L78' title='Defined at 78 in src/campaign_server/control.hpp.'>args_count</a>()) <em class='brace'>{</em>
<a id='L277' name='L277'></a> 277                         <a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>["read_only"] = <a href='../Y/17145.html' title='Multiple used in 16 places.'>read_only_</a> = <a href='../D/15924.html' title='Multiple defined in 17 places.'>utils</a>::<a href='../S/116.html#L489' title='Defined at 489 in src/serialization/string_utils.cpp.'>string_bool</a>(<a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a>[1], <strong class='reserved'>true</strong>);
<a id='L278' name='L278'></a> 278                 <em class='brace'>}</em>
<a id='L279' name='L279'></a> 279 
<a id='L280' name='L280'></a> 280                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Read only mode: " &lt;&lt; (<a href='../Y/17145.html' title='Multiple used in 16 places.'>read_only_</a> ? "enabled" : "disabled") &lt;&lt; '\n';
<a id='L281' name='L281'></a> 281         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a> == "flush") <em class='brace'>{</em>
<a id='L282' name='L282'></a> 282                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Flushing config to disk...\n";
<a id='L283' name='L283'></a> 283                 <a href='../D/16579.html' title='Multiple defined in 4 places.'>write_config</a>();
<a id='L284' name='L284'></a> 284         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a> == "reload") <em class='brace'>{</em>
<a id='L285' name='L285'></a> 285                 <strong class='reserved'>if</strong>(<a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a>.<a href='../S/918.html#L78' title='Defined at 78 in src/campaign_server/control.hpp.'>args_count</a>()) <em class='brace'>{</em>
<a id='L286' name='L286'></a> 286                         <strong class='reserved'>if</strong>(<a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a>[1] == "blacklist") <em class='brace'>{</em>
<a id='L287' name='L287'></a> 287                                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Reloading blacklist...\n";
<a id='L288' name='L288'></a> 288                                 <a href='../S/921.html#L352' title='Defined at 352 in src/campaign_server/campaign_server.cpp.'>load_blacklist</a>();
<a id='L289' name='L289'></a> 289                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L290' name='L290'></a> 290                                 <a href='../S/921.html#L58' title='Defined at 58 in src/campaign_server/campaign_server.cpp.'>ERR_CS</a> &lt;&lt; "Unrecognized admin reload argument: " &lt;&lt; <a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a>[1] &lt;&lt; '\n';
<a id='L291' name='L291'></a> 291                         <em class='brace'>}</em>
<a id='L292' name='L292'></a> 292                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L293' name='L293'></a> 293                         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Reloading all configuration...\n";
<a id='L294' name='L294'></a> 294                         <a href='../D/9909.html' title='Multiple defined in 5 places.'>load_config</a>();
<a id='L295' name='L295'></a> 295                         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Reloaded configuration\n";
<a id='L296' name='L296'></a> 296                 <em class='brace'>}</em>
<a id='L297' name='L297'></a> 297         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a> == "setpass") <em class='brace'>{</em>
<a id='L298' name='L298'></a> 298                 <strong class='reserved'>if</strong>(<a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a>.<a href='../S/918.html#L78' title='Defined at 78 in src/campaign_server/control.hpp.'>args_count</a>() != 2) <em class='brace'>{</em>
<a id='L299' name='L299'></a> 299                         <a href='../S/921.html#L58' title='Defined at 58 in src/campaign_server/campaign_server.cpp.'>ERR_CS</a> &lt;&lt; "Incorrect number of arguments for 'setpass'\n";
<a id='L300' name='L300'></a> 300                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L301' name='L301'></a> 301                         <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../Y/5351.html' title='Multiple used in 33 places.'>addon_id</a> = <a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a>[1];
<a id='L302' name='L302'></a> 302                         <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../Y/15093.html' title='Multiple used in 3 places.'>newpass</a> = <a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a>[2];
<a id='L303' name='L303'></a> 303                         <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a> = <a href='../D/7380.html' title='Multiple defined in 2 places.'>get_campaign</a>(<a href='../Y/5351.html' title='Multiple used in 33 places.'>addon_id</a>);
<a id='L304' name='L304'></a> 304 
<a id='L305' name='L305'></a> 305                         <strong class='reserved'>if</strong>(!<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>) <em class='brace'>{</em>
<a id='L306' name='L306'></a> 306                                 <a href='../S/921.html#L58' title='Defined at 58 in src/campaign_server/campaign_server.cpp.'>ERR_CS</a> &lt;&lt; "Add-on '" &lt;&lt; <a href='../Y/5351.html' title='Multiple used in 33 places.'>addon_id</a> &lt;&lt; "' not found, cannot set passphrase\n";
<a id='L307' name='L307'></a> 307                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../Y/15093.html' title='Multiple used in 3 places.'>newpass</a>.<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()) <em class='brace'>{</em>
<a id='L308' name='L308'></a> 308                                 <em class='comment'>// Shouldn't happen!</em>
<a id='L309' name='L309'></a> 309                                 <a href='../S/921.html#L58' title='Defined at 58 in src/campaign_server/campaign_server.cpp.'>ERR_CS</a> &lt;&lt; "Add-on passphrases may not be empty!\n";
<a id='L310' name='L310'></a> 310                         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L311' name='L311'></a> 311                                 <a href='../S/921.html#L92' title='Defined at 92 in src/campaign_server/campaign_server.cpp.'>set_passphrase</a>(<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>, <a href='../Y/15093.html' title='Multiple used in 3 places.'>newpass</a>);
<a id='L312' name='L312'></a> 312                                 <a href='../D/16579.html' title='Multiple defined in 4 places.'>write_config</a>();
<a id='L313' name='L313'></a> 313                                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "New passphrase set for '" &lt;&lt; <a href='../Y/5351.html' title='Multiple used in 33 places.'>addon_id</a> &lt;&lt; "'\n";
<a id='L314' name='L314'></a> 314                         <em class='brace'>}</em>
<a id='L315' name='L315'></a> 315                 <em class='brace'>}</em>
<a id='L316' name='L316'></a> 316         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L317' name='L317'></a> 317                 <a href='../S/921.html#L58' title='Defined at 58 in src/campaign_server/campaign_server.cpp.'>ERR_CS</a> &lt;&lt; "Unrecognized admin command: " &lt;&lt; <a href='../Y/8080.html' title='Multiple used in 15 places.'>ctl</a>.<a href='../S/918.html#L110' title='Defined at 110 in src/campaign_server/control.hpp.'>full</a>() &lt;&lt; '\n';
<a id='L318' name='L318'></a> 318         <em class='brace'>}</em>
<a id='L319' name='L319'></a> 319 
<a id='L320' name='L320'></a> 320         <a href='../S/166.html#L126' title='Defined at 126 in src/server/server_base.cpp.'>read_from_fifo</a>();
<a id='L321' name='L321'></a> 321 <em class='brace'>}</em>
<a id='L322' name='L322'></a> 322 
<a id='L323' name='L323'></a> 323 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../R/7565.html' title='Multiple referred from 6 places.'>handle_sighup</a>(<strong class='reserved'>const</strong> <a href='../D/3739.html' title='Multiple defined in 4 places.'>boost</a>::<a href='../Y/19618.html' title='Multiple used in 72 places.'>system</a>::<a href='../Y/9622.html' title='Multiple used in 102 places.'>error_code</a>&amp;, <strong class='reserved'>int</strong>)
<a id='L324' name='L324'></a> 324 <em class='brace'>{</em>
<a id='L325' name='L325'></a> 325         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "SIGHUP caught, reloading config.\n";
<a id='L326' name='L326'></a> 326 
<a id='L327' name='L327'></a> 327         <a href='../D/9909.html' title='Multiple defined in 5 places.'>load_config</a>(); <em class='comment'>// TODO: handle port number config changes</em>
<a id='L328' name='L328'></a> 328 
<a id='L329' name='L329'></a> 329         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Reloaded configuration\n";
<a id='L330' name='L330'></a> 330 
<a id='L331' name='L331'></a> 331         <a href='../Y/18785.html' title='Multiple used in 5 places.'>sighup_</a>.<a href='../Y/5903.html' title='Multiple used in 8 places.'>async_wait</a>(<a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/3645.html' title='Multiple defined in 3 places.'>bind</a>(&amp;<a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../D/8411.html' title='Multiple defined in 2 places.'>handle_sighup</a>, <strong class='reserved'>this</strong>, <a href='../Y/4797.html' title='Multiple used in 111 places.'>_1</a>, <a href='../Y/4798.html' title='Multiple used in 131 places.'>_2</a>));
<a id='L332' name='L332'></a> 332 <em class='brace'>}</em>
<a id='L333' name='L333'></a> 333 
<a id='L334' name='L334'></a> 334 <em class='sharp'>#endif</em>
<a id='L335' name='L335'></a> 335 
<a id='L336' name='L336'></a> 336 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../R/5716.html' title='Multiple referred from 3 places.'>flush_cfg</a>()
<a id='L337' name='L337'></a> 337 <em class='brace'>{</em>
<a id='L338' name='L338'></a> 338         <a href='../S/921.html#L114' title='Defined at 114 in src/campaign_server/campaign_server.cpp.'>flush_timer_</a>.<a href='../Y/9797.html' title='Multiple used in 4 places.'>expires_from_now</a>(<a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/7440.html' title='Multiple used in 11 places.'>chrono</a>::<a href='../Y/14308.html' title='Multiple used in 8 places.'>minutes</a>(10));
<a id='L339' name='L339'></a> 339         <a href='../S/921.html#L114' title='Defined at 114 in src/campaign_server/campaign_server.cpp.'>flush_timer_</a>.<a href='../Y/5903.html' title='Multiple used in 8 places.'>async_wait</a>(<a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/3645.html' title='Multiple defined in 3 places.'>bind</a>(&amp;<a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../S/921.html#L342' title='Defined at 342 in src/campaign_server/campaign_server.cpp.'>handle_flush</a>, <strong class='reserved'>this</strong>, <a href='../Y/4797.html' title='Multiple used in 111 places.'>_1</a>));
<a id='L340' name='L340'></a> 340 <em class='brace'>}</em>
<a id='L341' name='L341'></a> 341 
<a id='L342' name='L342'></a> 342 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../R/7505.html' title='Multiple referred from 2 places.'>handle_flush</a>(<strong class='reserved'>const</strong> <a href='../D/3739.html' title='Multiple defined in 4 places.'>boost</a>::<a href='../Y/19618.html' title='Multiple used in 72 places.'>system</a>::<a href='../Y/9622.html' title='Multiple used in 102 places.'>error_code</a>&amp; <a href='../D/5980.html' title='Multiple defined in 22 places.'>error</a>)
<a id='L343' name='L343'></a> 343 <em class='brace'>{</em>
<a id='L344' name='L344'></a> 344         <strong class='reserved'>if</strong>(<a href='../D/5980.html' title='Multiple defined in 22 places.'>error</a>) <em class='brace'>{</em>
<a id='L345' name='L345'></a> 345                 <a href='../S/921.html#L58' title='Defined at 58 in src/campaign_server/campaign_server.cpp.'>ERR_CS</a> &lt;&lt; "Error from reload timer: " &lt;&lt; <a href='../D/5980.html' title='Multiple defined in 22 places.'>error</a>.<a href='../D/10972.html' title='Multiple defined in 7 places.'>message</a>() &lt;&lt; "\n";
<a id='L346' name='L346'></a> 346                 <strong class='reserved'>throw</strong> <a href='../D/3739.html' title='Multiple defined in 4 places.'>boost</a>::<a href='../Y/19618.html' title='Multiple used in 72 places.'>system</a>::<a href='../Y/19619.html' title='Multiple used in 16 places.'>system_error</a>(<a href='../D/5980.html' title='Multiple defined in 22 places.'>error</a>);
<a id='L347' name='L347'></a> 347         <em class='brace'>}</em>
<a id='L348' name='L348'></a> 348         <a href='../D/16579.html' title='Multiple defined in 4 places.'>write_config</a>();
<a id='L349' name='L349'></a> 349         <a href='../S/921.html#L336' title='Defined at 336 in src/campaign_server/campaign_server.cpp.'>flush_cfg</a>();
<a id='L350' name='L350'></a> 350 <em class='brace'>}</em>
<a id='L351' name='L351'></a> 351 
<a id='L352' name='L352'></a> 352 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../R/8976.html' title='Multiple referred from 3 places.'>load_blacklist</a>()
<a id='L353' name='L353'></a> 353 <em class='brace'>{</em>
<a id='L354' name='L354'></a> 354         <em class='comment'>// We *always* want to clear the blacklist first, especially if we are</em>
<a id='L355' name='L355'></a> 355         <em class='comment'>// reloading the configuration and the blacklist is no longer enabled.</em>
<a id='L356' name='L356'></a> 356         <a href='../Y/6526.html' title='Multiple used in 5 places.'>blacklist_</a>.<a href='../D/4477.html' title='Multiple defined in 39 places.'>clear</a>();
<a id='L357' name='L357'></a> 357 
<a id='L358' name='L358'></a> 358         <strong class='reserved'>if</strong>(<a href='../Y/6527.html' title='Multiple used in 7 places.'>blacklist_file_</a>.<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()) <em class='brace'>{</em>
<a id='L359' name='L359'></a> 359                 <strong class='reserved'>return</strong>;
<a id='L360' name='L360'></a> 360         <em class='brace'>}</em>
<a id='L361' name='L361'></a> 361 
<a id='L362' name='L362'></a> 362         <strong class='reserved'>try</strong> <em class='brace'>{</em>
<a id='L363' name='L363'></a> 363                 <a href='../D/6226.html' title='Multiple defined in 6 places.'>filesystem</a>::<a href='../S/1257.html#L37' title='Defined at 37 in src/filesystem.hpp.'>scoped_istream</a> <a href='../D/8823.html' title='Multiple defined in 4 places.'>in</a> = <a href='../D/6226.html' title='Multiple defined in 6 places.'>filesystem</a>::<a href='../S/314.html#L764' title='Defined at 764 in src/filesystem_boost.cpp.'>istream_file</a>(<a href='../Y/6527.html' title='Multiple used in 7 places.'>blacklist_file_</a>);
<a id='L364' name='L364'></a> 364                 <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a> <a href='../Y/6530.html' title='Multiple used in 3 places.'>blcfg</a>;
<a id='L365' name='L365'></a> 365 
<a id='L366' name='L366'></a> 366                 <a href='../D/12406.html' title='Multiple defined in 23 places.'>read</a>(<a href='../Y/6530.html' title='Multiple used in 3 places.'>blcfg</a>, *<a href='../D/8823.html' title='Multiple defined in 4 places.'>in</a>);
<a id='L367' name='L367'></a> 367 
<a id='L368' name='L368'></a> 368                 <a href='../Y/6526.html' title='Multiple used in 5 places.'>blacklist_</a>.<a href='../D/12406.html' title='Multiple defined in 23 places.'>read</a>(<a href='../Y/6530.html' title='Multiple used in 3 places.'>blcfg</a>);
<a id='L369' name='L369'></a> 369                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "using blacklist from " &lt;&lt; <a href='../Y/6527.html' title='Multiple used in 7 places.'>blacklist_file_</a> &lt;&lt; '\n';
<a id='L370' name='L370'></a> 370         <em class='brace'>}</em> <strong class='reserved'>catch</strong>(<strong class='reserved'>const</strong> <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>::<a href='../D/5980.html' title='Multiple defined in 22 places.'>error</a>&amp;) <em class='brace'>{</em>
<a id='L371' name='L371'></a> 371                 <a href='../S/921.html#L58' title='Defined at 58 in src/campaign_server/campaign_server.cpp.'>ERR_CS</a> &lt;&lt; "failed to read blacklist from " &lt;&lt; <a href='../Y/6527.html' title='Multiple used in 7 places.'>blacklist_file_</a> &lt;&lt; ", blacklist disabled\n";
<a id='L372' name='L372'></a> 372         <em class='brace'>}</em>
<a id='L373' name='L373'></a> 373 <em class='brace'>}</em>
<a id='L374' name='L374'></a> 374 
<a id='L375' name='L375'></a> 375 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../R/15085.html' title='Multiple referred from 15 places.'>write_config</a>()
<a id='L376' name='L376'></a> 376 <em class='brace'>{</em>
<a id='L377' name='L377'></a> 377         <a href='../S/921.html#L55' title='Defined at 55 in src/campaign_server/campaign_server.cpp.'>DBG_CS</a> &lt;&lt; "writing configuration and add-ons list to disk...\n";
<a id='L378' name='L378'></a> 378         <a href='../D/6226.html' title='Multiple defined in 6 places.'>filesystem</a>::<a href='../D/3445.html' title='Multiple defined in 2 places.'>atomic_commit</a> <a href='../Y/15951.html' title='Multiple used in 688 places.'>out</a>(<a href='../Y/7193.html' title='Multiple used in 5 places.'>cfg_file_</a>);
<a id='L379' name='L379'></a> 379         <a href='../D/16565.html' title='Multiple defined in 55 places.'>write</a>(*<a href='../Y/15951.html' title='Multiple used in 688 places.'>out</a>.<a href='../S/916.html#L72' title='Defined at 72 in src/campaign_server/fs_commit.hpp.'>ostream</a>(), <a href='../D/4197.html' title='Multiple defined in 11 places.'>cfg_</a>);
<a id='L380' name='L380'></a> 380         <a href='../Y/15951.html' title='Multiple used in 688 places.'>out</a>.<a href='../D/4656.html' title='Multiple defined in 2 places.'>commit</a>();
<a id='L381' name='L381'></a> 381         <a href='../S/921.html#L55' title='Defined at 55 in src/campaign_server/campaign_server.cpp.'>DBG_CS</a> &lt;&lt; "... done\n";
<a id='L382' name='L382'></a> 382 <em class='brace'>}</em>
<a id='L383' name='L383'></a> 383 
<a id='L384' name='L384'></a> 384 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../R/5666.html' title='Multiple referred from 212 places.'>fire</a>(<strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../Y/11678.html' title='Multiple used in 17 places.'>hook</a>, <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../S/4094.html#L323' title='Defined at 323 in data/tools/wesnoth/libgithub.py.'>addon</a>)
<a id='L385' name='L385'></a> 385 <em class='brace'>{</em>
<a id='L386' name='L386'></a> 386         <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/10772.html' title='Multiple defined in 18 places.'>map</a>&lt;<a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>, <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&gt;::<a href='../D/4857.html' title='Multiple defined in 13 places.'>const_iterator</a> <a href='../Y/12605.html' title='Multiple used in 506 places.'>itor</a> = <a href='../Y/11682.html' title='Multiple used in 6 places.'>hooks_</a>.<a href='../D/6279.html' title='Multiple defined in 39 places.'>find</a>(<a href='../Y/11678.html' title='Multiple used in 17 places.'>hook</a>);
<a id='L387' name='L387'></a> 387         <strong class='reserved'>if</strong>(<a href='../Y/12605.html' title='Multiple used in 506 places.'>itor</a> == <a href='../Y/11682.html' title='Multiple used in 6 places.'>hooks_</a>.<a href='../D/5899.html' title='Multiple defined in 28 places.'>end</a>()) <em class='brace'>{</em>
<a id='L388' name='L388'></a> 388                 <strong class='reserved'>return</strong>;
<a id='L389' name='L389'></a> 389         <em class='brace'>}</em>
<a id='L390' name='L390'></a> 390 
<a id='L391' name='L391'></a> 391         <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../Y/18114.html' title='Multiple used in 4 places.'>script</a> = <a href='../Y/12605.html' title='Multiple used in 506 places.'>itor</a>-&gt;<a href='../Y/18207.html' title='Multiple used in 1330 places.'>second</a>;
<a id='L392' name='L392'></a> 392         <strong class='reserved'>if</strong>(<a href='../Y/18114.html' title='Multiple used in 4 places.'>script</a>.<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()) <em class='brace'>{</em>
<a id='L393' name='L393'></a> 393                 <strong class='reserved'>return</strong>;
<a id='L394' name='L394'></a> 394         <em class='brace'>}</em>
<a id='L395' name='L395'></a> 395 
<a id='L396' name='L396'></a> 396 <em class='sharp'>#if</em> <strong class='reserved'>defined</strong>(<a href='../Y/4851.html' title='Multiple used in 105 places.'>_WIN32</a>)
<a id='L397' name='L397'></a> 397         (<strong class='reserved'>void</strong>)<a href='../S/4094.html#L323' title='Defined at 323 in data/tools/wesnoth/libgithub.py.'>addon</a>;
<a id='L398' name='L398'></a> 398         <a href='../S/921.html#L58' title='Defined at 58 in src/campaign_server/campaign_server.cpp.'>ERR_CS</a> &lt;&lt; "Tried to execute a script on an unsupported platform\n";
<a id='L399' name='L399'></a> 399         <strong class='reserved'>return</strong>;
<a id='L400' name='L400'></a> 400 <em class='sharp'>#else</em>
<a id='L401' name='L401'></a> 401         <a href='../Y/16384.html' title='Multiple used in 3 places.'>pid_t</a> <a href='../Y/7403.html' title='Multiple used in 3 places.'>childpid</a>;
<a id='L402' name='L402'></a> 402 
<a id='L403' name='L403'></a> 403         <strong class='reserved'>if</strong>((<a href='../Y/7403.html' title='Multiple used in 3 places.'>childpid</a> = <a href='../Y/10406.html' title='Multiple used in 3 places.'>fork</a>()) == -1) <em class='brace'>{</em>
<a id='L404' name='L404'></a> 404                 <a href='../S/921.html#L58' title='Defined at 58 in src/campaign_server/campaign_server.cpp.'>ERR_CS</a> &lt;&lt; "fork failed while updating campaign " &lt;&lt; <a href='../S/4094.html#L323' title='Defined at 323 in data/tools/wesnoth/libgithub.py.'>addon</a> &lt;&lt; '\n';
<a id='L405' name='L405'></a> 405                 <strong class='reserved'>return</strong>;
<a id='L406' name='L406'></a> 406         <em class='brace'>}</em>
<a id='L407' name='L407'></a> 407 
<a id='L408' name='L408'></a> 408         <strong class='reserved'>if</strong>(<a href='../Y/7403.html' title='Multiple used in 3 places.'>childpid</a> == 0) <em class='brace'>{</em>
<a id='L409' name='L409'></a> 409                 <em class='comment'>// We are the child process. Execute the script. We run as a</em>
<a id='L410' name='L410'></a> 410                 <em class='comment'>// separate thread sharing stdout/stderr, which will make the</em>
<a id='L411' name='L411'></a> 411                 <em class='comment'>// log look ugly.</em>
<a id='L412' name='L412'></a> 412                 <a href='../Y/9730.html' title='Multiple used in 2 places.'>execlp</a>(<a href='../Y/18114.html' title='Multiple used in 4 places.'>script</a>.<a href='../D/3892.html' title='Multiple defined in 2 places.'>c_str</a>(), <a href='../Y/18114.html' title='Multiple used in 4 places.'>script</a>.<a href='../D/3892.html' title='Multiple defined in 2 places.'>c_str</a>(), <a href='../S/4094.html#L323' title='Defined at 323 in data/tools/wesnoth/libgithub.py.'>addon</a>.<a href='../D/3892.html' title='Multiple defined in 2 places.'>c_str</a>(), <strong class='reserved'>static_cast</strong>&lt;<strong class='reserved'>char</strong> *&gt;(<a href='../Y/15374.html' title='Multiple used in 2007 places.'>nullptr</a>));
<a id='L413' name='L413'></a> 413 
<a id='L414' name='L414'></a> 414                 <em class='comment'>// exec() and family never return; if they do, we have a problem</em>
<a id='L415' name='L415'></a> 415                 <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/7179.html' title='Multiple used in 228 places.'>cerr</a> &lt;&lt; "ERROR: exec failed with errno " &lt;&lt; <a href='../Y/9614.html' title='Multiple used in 17 places.'>errno</a> &lt;&lt; " for addon " &lt;&lt; <a href='../S/4094.html#L323' title='Defined at 323 in data/tools/wesnoth/libgithub.py.'>addon</a>
<a id='L416' name='L416'></a> 416                                   &lt;&lt; '\n';
<a id='L417' name='L417'></a> 417                 <a href='../Y/9749.html' title='Multiple used in 110 places.'>exit</a>(<a href='../Y/9614.html' title='Multiple used in 17 places.'>errno</a>);
<a id='L418' name='L418'></a> 418 
<a id='L419' name='L419'></a> 419         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L420' name='L420'></a> 420                 <strong class='reserved'>return</strong>;
<a id='L421' name='L421'></a> 421         <em class='brace'>}</em>
<a id='L422' name='L422'></a> 422 <em class='sharp'>#endif</em>
<a id='L423' name='L423'></a> 423 <em class='brace'>}</em>
<a id='L424' name='L424'></a> 424 
<a id='L425' name='L425'></a> 425 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../R/12357.html' title='Multiple referred from 5 places.'>send_message</a>(<strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../S/786.html#L110' title='Defined at 110 in src/formula/debugger.cpp.'>msg</a>, <a href='../S/151.html#L33' title='Defined at 33 in src/server/server_base.hpp.'>socket_ptr</a> <a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>)
<a id='L426' name='L426'></a> 426 <em class='brace'>{</em>
<a id='L427' name='L427'></a> 427         <a href='../D/14558.html' title='Multiple defined in 2 places.'>simple_wml</a>::<a href='../D/5662.html' title='Multiple defined in 2 places.'>document</a> <a href='../Y/9007.html' title='Multiple used in 150 places.'>doc</a>;
<a id='L428' name='L428'></a> 428         <a href='../Y/9007.html' title='Multiple used in 150 places.'>doc</a>.<a href='../D/13032.html' title='Multiple defined in 2 places.'>root</a>().<a href='../D/2855.html' title='Multiple defined in 8 places.'>add_child</a>("message").<a href='../D/13633.html' title='Multiple defined in 3 places.'>set_attr_dup</a>("message", <a href='../S/786.html#L110' title='Defined at 110 in src/formula/debugger.cpp.'>msg</a>.<a href='../D/3892.html' title='Multiple defined in 2 places.'>c_str</a>());
<a id='L429' name='L429'></a> 429         <a href='../Y/5901.html' title='Multiple used in 24 places.'>async_send_doc</a>(<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>, <a href='../Y/9007.html' title='Multiple used in 150 places.'>doc</a>, <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/3645.html' title='Multiple defined in 3 places.'>bind</a>(&amp;<a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../D/8386.html' title='Multiple defined in 2 places.'>handle_new_client</a>, <strong class='reserved'>this</strong>, <a href='../Y/4797.html' title='Multiple used in 111 places.'>_1</a>), <a href='../Y/15366.html' title='Multiple used in 3 places.'>null_handler</a>);
<a id='L430' name='L430'></a> 430 <em class='brace'>}</em>
<a id='L431' name='L431'></a> 431 
<a id='L432' name='L432'></a> 432 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../R/12352.html' title='Multiple referred from 33 places.'>send_error</a>(<strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../S/786.html#L110' title='Defined at 110 in src/formula/debugger.cpp.'>msg</a>, <a href='../S/151.html#L33' title='Defined at 33 in src/server/server_base.hpp.'>socket_ptr</a> <a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>)
<a id='L433' name='L433'></a> 433 <em class='brace'>{</em>
<a id='L434' name='L434'></a> 434         <a href='../S/921.html#L58' title='Defined at 58 in src/campaign_server/campaign_server.cpp.'>ERR_CS</a> &lt;&lt; "[" &lt;&lt; <a href='../S/166.html#L156' title='Defined at 156 in src/server/server_base.cpp.'>client_address</a>(<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>) &lt;&lt; "]: " &lt;&lt; <a href='../S/786.html#L110' title='Defined at 110 in src/formula/debugger.cpp.'>msg</a> &lt;&lt; '\n';
<a id='L435' name='L435'></a> 435         <a href='../D/14558.html' title='Multiple defined in 2 places.'>simple_wml</a>::<a href='../D/5662.html' title='Multiple defined in 2 places.'>document</a> <a href='../Y/9007.html' title='Multiple used in 150 places.'>doc</a>;
<a id='L436' name='L436'></a> 436         <a href='../Y/9007.html' title='Multiple used in 150 places.'>doc</a>.<a href='../D/13032.html' title='Multiple defined in 2 places.'>root</a>().<a href='../D/2855.html' title='Multiple defined in 8 places.'>add_child</a>("error").<a href='../D/13633.html' title='Multiple defined in 3 places.'>set_attr_dup</a>("message", <a href='../S/786.html#L110' title='Defined at 110 in src/formula/debugger.cpp.'>msg</a>.<a href='../D/3892.html' title='Multiple defined in 2 places.'>c_str</a>());
<a id='L437' name='L437'></a> 437         <a href='../Y/5901.html' title='Multiple used in 24 places.'>async_send_doc</a>(<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>, <a href='../Y/9007.html' title='Multiple used in 150 places.'>doc</a>, <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/3645.html' title='Multiple defined in 3 places.'>bind</a>(&amp;<a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../D/8386.html' title='Multiple defined in 2 places.'>handle_new_client</a>, <strong class='reserved'>this</strong>, <a href='../Y/4797.html' title='Multiple used in 111 places.'>_1</a>), <a href='../Y/15366.html' title='Multiple used in 3 places.'>null_handler</a>);
<a id='L438' name='L438'></a> 438 <em class='brace'>}</em>
<a id='L439' name='L439'></a> 439 
<a id='L440' name='L440'></a> 440 <em class='sharp'>#define</em> <a href='../R/1670.html' title='Multiple referred from 6 places.'>REGISTER_CAMPAIGND_HANDLER</a>(<a href='../Y/17560.html' title='Multiple used in 2 places.'>req_id</a>) \
<a id='L441' name='L441'></a> 441         <a href='../Y/11337.html' title='Multiple used in 7 places.'>handlers_</a>[#<a href='../Y/17560.html' title='Multiple used in 2 places.'>req_id</a>] = <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/3645.html' title='Multiple defined in 3 places.'>bind</a>(&amp;<a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../Y/11326.html' title='Multiple used in 13 places.'>handle_</a>##<a href='../Y/17560.html' title='Multiple used in 2 places.'>req_id</a>, \
<a id='L442' name='L442'></a> 442                 <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/16416.html' title='Multiple used in 10 places.'>placeholders</a>::<a href='../Y/4797.html' title='Multiple used in 111 places.'>_1</a>, <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/16416.html' title='Multiple used in 10 places.'>placeholders</a>::<a href='../Y/4798.html' title='Multiple used in 131 places.'>_2</a>)
<a id='L443' name='L443'></a> 443 
<a id='L444' name='L444'></a> 444 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../Y/17396.html' title='Multiple used in 3 places.'>register_handlers</a>()
<a id='L445' name='L445'></a> 445 <em class='brace'>{</em>
<a id='L446' name='L446'></a> 446         <a href='../S/921.html#L440' title='Defined at 440 in src/campaign_server/campaign_server.cpp.'>REGISTER_CAMPAIGND_HANDLER</a>(request_campaign_list);
<a id='L447' name='L447'></a> 447         <a href='../S/921.html#L440' title='Defined at 440 in src/campaign_server/campaign_server.cpp.'>REGISTER_CAMPAIGND_HANDLER</a>(request_campaign);
<a id='L448' name='L448'></a> 448         <a href='../S/921.html#L440' title='Defined at 440 in src/campaign_server/campaign_server.cpp.'>REGISTER_CAMPAIGND_HANDLER</a>(request_terms);
<a id='L449' name='L449'></a> 449         <a href='../S/921.html#L440' title='Defined at 440 in src/campaign_server/campaign_server.cpp.'>REGISTER_CAMPAIGND_HANDLER</a>(<a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>);
<a id='L450' name='L450'></a> 450         <a href='../S/921.html#L440' title='Defined at 440 in src/campaign_server/campaign_server.cpp.'>REGISTER_CAMPAIGND_HANDLER</a>(<strong class='reserved'>delete</strong>);
<a id='L451' name='L451'></a> 451         <a href='../S/921.html#L440' title='Defined at 440 in src/campaign_server/campaign_server.cpp.'>REGISTER_CAMPAIGND_HANDLER</a>(<a href='../S/4093.html#L237' title='Defined at 237 in data/tools/wesnoth/campaignserver_client.py.'>change_passphrase</a>);
<a id='L452' name='L452'></a> 452 <em class='brace'>}</em>
<a id='L453' name='L453'></a> 453 
<a id='L454' name='L454'></a> 454 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../S/922.html#L166' title='Referred from 166 in src/campaign_server/campaign_server.hpp.'>handle_request_campaign_list</a>(<strong class='reserved'>const</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../D/12850.html' title='Multiple defined in 3 places.'>request</a>&amp; <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>)
<a id='L455' name='L455'></a> 455 <em class='brace'>{</em>
<a id='L456' name='L456'></a> 456         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "sending campaign list to " &lt;&lt; <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../S/922.html#L74' title='Defined at 74 in src/campaign_server/campaign_server.hpp.'>addr</a> &lt;&lt; " using gzip\n";
<a id='L457' name='L457'></a> 457 
<a id='L458' name='L458'></a> 458         <a href='../Y/20322.html' title='Multiple used in 138 places.'>time_t</a> <a href='../Y/9550.html' title='Multiple used in 12 places.'>epoch</a> = <a href='../D/15224.html' title='Multiple defined in 4 places.'>time</a>(<a href='../Y/15374.html' title='Multiple used in 2007 places.'>nullptr</a>);
<a id='L459' name='L459'></a> 459         <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a> <a href='../Y/7041.html' title='Multiple used in 5 places.'>campaign_list</a>;
<a id='L460' name='L460'></a> 460 
<a id='L461' name='L461'></a> 461         <a href='../Y/7041.html' title='Multiple used in 5 places.'>campaign_list</a>["timestamp"] = <a href='../Y/9550.html' title='Multiple used in 12 places.'>epoch</a>;
<a id='L462' name='L462'></a> 462         <strong class='reserved'>if</strong>(<a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../D/4196.html' title='Multiple defined in 5 places.'>cfg</a>["times_relative_to"] != "now") <em class='brace'>{</em>
<a id='L463' name='L463'></a> 463                 <a href='../Y/9550.html' title='Multiple used in 12 places.'>epoch</a> = 0;
<a id='L464' name='L464'></a> 464         <em class='brace'>}</em>
<a id='L465' name='L465'></a> 465 
<a id='L466' name='L466'></a> 466         <strong class='reserved'>bool</strong> <a href='../Y/6353.html' title='Multiple used in 3 places.'>before_flag</a> = <strong class='reserved'>false</strong>;
<a id='L467' name='L467'></a> 467         <a href='../Y/20322.html' title='Multiple used in 138 places.'>time_t</a> <a href='../Y/6350.html' title='Multiple used in 164 places.'>before</a> = <a href='../Y/9550.html' title='Multiple used in 12 places.'>epoch</a>;
<a id='L468' name='L468'></a> 468         <strong class='reserved'>try</strong> <em class='brace'>{</em>
<a id='L469' name='L469'></a> 469                 <a href='../Y/6350.html' title='Multiple used in 164 places.'>before</a> = <a href='../Y/6350.html' title='Multiple used in 164 places.'>before</a> + <a href='../S/684.html#L94' title='Defined at 94 in src/lexical_cast.hpp.'>lexical_cast</a>&lt;<a href='../Y/20322.html' title='Multiple used in 138 places.'>time_t</a>&gt;(<a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../D/4196.html' title='Multiple defined in 5 places.'>cfg</a>["before"]);
<a id='L470' name='L470'></a> 470                 <a href='../Y/6353.html' title='Multiple used in 3 places.'>before_flag</a> = <strong class='reserved'>true</strong>;
<a id='L471' name='L471'></a> 471         <em class='brace'>}</em> <strong class='reserved'>catch</strong>(<a href='../S/684.html#L117' title='Defined at 117 in src/lexical_cast.hpp.'>bad_lexical_cast</a>) <em class='brace'>{</em><em class='brace'>}</em>
<a id='L472' name='L472'></a> 472 
<a id='L473' name='L473'></a> 473         <strong class='reserved'>bool</strong> <a href='../Y/5443.html' title='Multiple used in 3 places.'>after_flag</a> = <strong class='reserved'>false</strong>;
<a id='L474' name='L474'></a> 474         <a href='../Y/20322.html' title='Multiple used in 138 places.'>time_t</a> <a href='../Y/5439.html' title='Multiple used in 175 places.'>after</a> = <a href='../Y/9550.html' title='Multiple used in 12 places.'>epoch</a>;
<a id='L475' name='L475'></a> 475         <strong class='reserved'>try</strong> <em class='brace'>{</em>
<a id='L476' name='L476'></a> 476                 <a href='../Y/5439.html' title='Multiple used in 175 places.'>after</a> = <a href='../Y/5439.html' title='Multiple used in 175 places.'>after</a> + <a href='../S/684.html#L94' title='Defined at 94 in src/lexical_cast.hpp.'>lexical_cast</a>&lt;<a href='../Y/20322.html' title='Multiple used in 138 places.'>time_t</a>&gt;(<a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../D/4196.html' title='Multiple defined in 5 places.'>cfg</a>["after"]);
<a id='L477' name='L477'></a> 477                 <a href='../Y/5443.html' title='Multiple used in 3 places.'>after_flag</a> = <strong class='reserved'>true</strong>;
<a id='L478' name='L478'></a> 478         <em class='brace'>}</em> <strong class='reserved'>catch</strong>(<a href='../S/684.html#L117' title='Defined at 117 in src/lexical_cast.hpp.'>bad_lexical_cast</a>) <em class='brace'>{</em><em class='brace'>}</em>
<a id='L479' name='L479'></a> 479 
<a id='L480' name='L480'></a> 480         <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../D/11310.html' title='Multiple defined in 24 places.'>name</a> = <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../D/4196.html' title='Multiple defined in 5 places.'>cfg</a>["name"];
<a id='L481' name='L481'></a> 481         <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../S/1786.html#L227' title='Defined at 227 in doc/design/umcd/communication_protocol.tex.'>lang</a> = <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../D/4196.html' title='Multiple defined in 5 places.'>cfg</a>["language"];
<a id='L482' name='L482'></a> 482 
<a id='L483' name='L483'></a> 483         <strong class='reserved'>for</strong>(<strong class='reserved'>const</strong> <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../D/8660.html' title='Multiple defined in 5 places.'>i</a> : <a href='../D/4086.html' title='Multiple defined in 2 places.'>campaigns</a>().<a href='../D/4431.html' title='Multiple defined in 2 places.'>child_range</a>("campaign"))
<a id='L484' name='L484'></a> 484         <em class='brace'>{</em>
<a id='L485' name='L485'></a> 485                 <strong class='reserved'>if</strong>(!<a href='../D/11310.html' title='Multiple defined in 24 places.'>name</a>.<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>() &amp;&amp; <a href='../D/11310.html' title='Multiple defined in 24 places.'>name</a> != <a href='../D/8660.html' title='Multiple defined in 5 places.'>i</a>["name"]) <em class='brace'>{</em>
<a id='L486' name='L486'></a> 486                         <strong class='reserved'>continue</strong>;
<a id='L487' name='L487'></a> 487                 <em class='brace'>}</em>
<a id='L488' name='L488'></a> 488 
<a id='L489' name='L489'></a> 489                 <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../Y/20388.html' title='Multiple used in 149 places.'>tm</a> = <a href='../D/8660.html' title='Multiple defined in 5 places.'>i</a>["timestamp"];
<a id='L490' name='L490'></a> 490 
<a id='L491' name='L491'></a> 491                 <strong class='reserved'>if</strong>(<a href='../Y/6353.html' title='Multiple used in 3 places.'>before_flag</a> &amp;&amp; (<a href='../Y/20388.html' title='Multiple used in 149 places.'>tm</a>.<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>() || <a href='../S/684.html#L111' title='Defined at 111 in src/lexical_cast.hpp.'>lexical_cast_default</a>&lt;<a href='../Y/20322.html' title='Multiple used in 138 places.'>time_t</a>&gt;(<a href='../Y/20388.html' title='Multiple used in 149 places.'>tm</a>, 0) &gt;= <a href='../Y/6350.html' title='Multiple used in 164 places.'>before</a>)) <em class='brace'>{</em>
<a id='L492' name='L492'></a> 492                         <strong class='reserved'>continue</strong>;
<a id='L493' name='L493'></a> 493                 <em class='brace'>}</em>
<a id='L494' name='L494'></a> 494                 <strong class='reserved'>if</strong>(<a href='../Y/5443.html' title='Multiple used in 3 places.'>after_flag</a> &amp;&amp; (<a href='../Y/20388.html' title='Multiple used in 149 places.'>tm</a>.<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>() || <a href='../S/684.html#L111' title='Defined at 111 in src/lexical_cast.hpp.'>lexical_cast_default</a>&lt;<a href='../Y/20322.html' title='Multiple used in 138 places.'>time_t</a>&gt;(<a href='../Y/20388.html' title='Multiple used in 149 places.'>tm</a>, 0) &lt;= <a href='../Y/5439.html' title='Multiple used in 175 places.'>after</a>)) <em class='brace'>{</em>
<a id='L495' name='L495'></a> 495                         <strong class='reserved'>continue</strong>;
<a id='L496' name='L496'></a> 496                 <em class='brace'>}</em>
<a id='L497' name='L497'></a> 497 
<a id='L498' name='L498'></a> 498                 <strong class='reserved'>if</strong>(!<a href='../S/1786.html#L227' title='Defined at 227 in doc/design/umcd/communication_protocol.tex.'>lang</a>.<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()) <em class='brace'>{</em>
<a id='L499' name='L499'></a> 499                         <strong class='reserved'>bool</strong> <a href='../S/1674.html#L200' title='Defined at 200 in utils/umc_dev/manual/dev_manual.tex.'>found</a> = <strong class='reserved'>false</strong>;
<a id='L500' name='L500'></a> 500 
<a id='L501' name='L501'></a> 501                         <strong class='reserved'>for</strong>(<strong class='reserved'>const</strong> <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a> : <a href='../D/8660.html' title='Multiple defined in 5 places.'>i</a>.<a href='../D/4431.html' title='Multiple defined in 2 places.'>child_range</a>("translation"))
<a id='L502' name='L502'></a> 502                         <em class='brace'>{</em>
<a id='L503' name='L503'></a> 503                                 <strong class='reserved'>if</strong>(<a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a>["language"] == <a href='../S/1786.html#L227' title='Defined at 227 in doc/design/umcd/communication_protocol.tex.'>lang</a>) <em class='brace'>{</em>
<a id='L504' name='L504'></a> 504                                         <a href='../S/1674.html#L200' title='Defined at 200 in utils/umc_dev/manual/dev_manual.tex.'>found</a> = <strong class='reserved'>true</strong>;
<a id='L505' name='L505'></a> 505                                         <strong class='reserved'>break</strong>;
<a id='L506' name='L506'></a> 506                                 <em class='brace'>}</em>
<a id='L507' name='L507'></a> 507                         <em class='brace'>}</em>
<a id='L508' name='L508'></a> 508 
<a id='L509' name='L509'></a> 509                         <strong class='reserved'>if</strong>(!<a href='../S/1674.html#L200' title='Defined at 200 in utils/umc_dev/manual/dev_manual.tex.'>found</a>) <em class='brace'>{</em>
<a id='L510' name='L510'></a> 510                                 <strong class='reserved'>continue</strong>;
<a id='L511' name='L511'></a> 511                         <em class='brace'>}</em>
<a id='L512' name='L512'></a> 512                 <em class='brace'>}</em>
<a id='L513' name='L513'></a> 513 
<a id='L514' name='L514'></a> 514                 <a href='../Y/7041.html' title='Multiple used in 5 places.'>campaign_list</a>.<a href='../D/2855.html' title='Multiple defined in 8 places.'>add_child</a>("campaign", <a href='../D/8660.html' title='Multiple defined in 5 places.'>i</a>);
<a id='L515' name='L515'></a> 515         <em class='brace'>}</em>
<a id='L516' name='L516'></a> 516 
<a id='L517' name='L517'></a> 517         <strong class='reserved'>for</strong>(<a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a> : <a href='../Y/7041.html' title='Multiple used in 5 places.'>campaign_list</a>.<a href='../D/4431.html' title='Multiple defined in 2 places.'>child_range</a>("campaign"))
<a id='L518' name='L518'></a> 518         <em class='brace'>{</em>
<a id='L519' name='L519'></a> 519                 <a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a>["passphrase"] = "";
<a id='L520' name='L520'></a> 520                 <a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a>["passhash"] = "";
<a id='L521' name='L521'></a> 521                 <a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a>["passsalt"] = "";
<a id='L522' name='L522'></a> 522                 <a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a>["upload_ip"] = "";
<a id='L523' name='L523'></a> 523                 <a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a>["email"] = "";
<a id='L524' name='L524'></a> 524                 <a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a>["feedback_url"] = "";
<a id='L525' name='L525'></a> 525 
<a id='L526' name='L526'></a> 526                 <em class='comment'>// Build a feedback_url string attribute from the</em>
<a id='L527' name='L527'></a> 527                 <em class='comment'>// internal [feedback] data.</em>
<a id='L528' name='L528'></a> 528                 <strong class='reserved'>const</strong> <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../Y/21344.html' title='Multiple used in 5 places.'>url_params</a> = <a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a>.<a href='../S/680.html#L385' title='Defined at 385 in src/config.cpp.'>child_or_empty</a>("feedback");
<a id='L529' name='L529'></a> 529                 <strong class='reserved'>if</strong>(!<a href='../Y/21344.html' title='Multiple used in 5 places.'>url_params</a>.<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>() &amp;&amp; !<a href='../Y/9966.html' title='Multiple used in 5 places.'>feedback_url_format_</a>.<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()) <em class='brace'>{</em>
<a id='L530' name='L530'></a> 530                         <a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a>["feedback_url"] = <a href='../S/920.html#L63' title='Defined at 63 in src/campaign_server/addon_utils.cpp.'>format_addon_feedback_url</a>(<a href='../Y/9966.html' title='Multiple used in 5 places.'>feedback_url_format_</a>, <a href='../Y/21344.html' title='Multiple used in 5 places.'>url_params</a>);
<a id='L531' name='L531'></a> 531                 <em class='brace'>}</em>
<a id='L532' name='L532'></a> 532 
<a id='L533' name='L533'></a> 533                 <em class='comment'>// Clients don't need to see the original data, so discard it.</em>
<a id='L534' name='L534'></a> 534                 <a href='../Y/12633.html' title='Multiple used in 478 places.'>j</a>.<a href='../S/1105.html#L507' title='Defined at 507 in src/config.hpp.'>clear_children</a>("feedback");
<a id='L535' name='L535'></a> 535         <em class='brace'>}</em>
<a id='L536' name='L536'></a> 536 
<a id='L537' name='L537'></a> 537         <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a> <a href='../S/1337.html#L149' title='Defined at 149 in utils/appveyor/irc-notify.py.'>response</a>;
<a id='L538' name='L538'></a> 538         <a href='../S/1337.html#L149' title='Defined at 149 in utils/appveyor/irc-notify.py.'>response</a>.<a href='../D/2855.html' title='Multiple defined in 8 places.'>add_child</a>("campaigns", <a href='../Y/7041.html' title='Multiple used in 5 places.'>campaign_list</a>);
<a id='L539' name='L539'></a> 539 
<a id='L540' name='L540'></a> 540         <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/15909.html' title='Multiple used in 229 places.'>ostringstream</a> <a href='../Y/15906.html' title='Multiple used in 3 places.'>ostr</a>;
<a id='L541' name='L541'></a> 541         <a href='../D/16565.html' title='Multiple defined in 55 places.'>write</a>(<a href='../Y/15906.html' title='Multiple used in 3 places.'>ostr</a>, <a href='../S/1337.html#L149' title='Defined at 149 in utils/appveyor/irc-notify.py.'>response</a>);
<a id='L542' name='L542'></a> 542         <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a> <a href='../D/16411.html' title='Multiple defined in 4 places.'>wml</a> = <a href='../Y/15906.html' title='Multiple used in 3 places.'>ostr</a>.<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>();
<a id='L543' name='L543'></a> 543         <a href='../D/14558.html' title='Multiple defined in 2 places.'>simple_wml</a>::<a href='../D/5662.html' title='Multiple defined in 2 places.'>document</a> <a href='../Y/9007.html' title='Multiple used in 150 places.'>doc</a>(<a href='../D/16411.html' title='Multiple defined in 4 places.'>wml</a>.<a href='../D/3892.html' title='Multiple defined in 2 places.'>c_str</a>(), <a href='../D/14558.html' title='Multiple defined in 2 places.'>simple_wml</a>::<a href='../S/152.html#L227' title='Defined at 227 in src/server/simple_wml.hpp.'>INIT_STATIC</a>);
<a id='L544' name='L544'></a> 544         <a href='../Y/9007.html' title='Multiple used in 150 places.'>doc</a>.<a href='../D/4746.html' title='Multiple defined in 2 places.'>compress</a>();
<a id='L545' name='L545'></a> 545 
<a id='L546' name='L546'></a> 546         <a href='../Y/5901.html' title='Multiple used in 24 places.'>async_send_doc</a>(<a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>, <a href='../Y/9007.html' title='Multiple used in 150 places.'>doc</a>, <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/3645.html' title='Multiple defined in 3 places.'>bind</a>(&amp;<a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../D/8386.html' title='Multiple defined in 2 places.'>handle_new_client</a>, <strong class='reserved'>this</strong>, <a href='../Y/4797.html' title='Multiple used in 111 places.'>_1</a>));
<a id='L547' name='L547'></a> 547 <em class='brace'>}</em>
<a id='L548' name='L548'></a> 548 
<a id='L549' name='L549'></a> 549 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../S/922.html#L167' title='Referred from 167 in src/campaign_server/campaign_server.hpp.'>handle_request_campaign</a>(<strong class='reserved'>const</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../D/12850.html' title='Multiple defined in 3 places.'>request</a>&amp; <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>)
<a id='L550' name='L550'></a> 550 <em class='brace'>{</em>
<a id='L551' name='L551'></a> 551         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "sending campaign '" &lt;&lt; <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../D/4196.html' title='Multiple defined in 5 places.'>cfg</a>["name"] &lt;&lt; "' to " &lt;&lt; <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../S/922.html#L74' title='Defined at 74 in src/campaign_server/campaign_server.hpp.'>addr</a> &lt;&lt; " using gzip\n";
<a id='L552' name='L552'></a> 552 
<a id='L553' name='L553'></a> 553         <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a> = <a href='../D/7380.html' title='Multiple defined in 2 places.'>get_campaign</a>(<a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../D/4196.html' title='Multiple defined in 5 places.'>cfg</a>["name"]);
<a id='L554' name='L554'></a> 554 
<a id='L555' name='L555'></a> 555         <strong class='reserved'>if</strong>(!<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>) <em class='brace'>{</em>
<a id='L556' name='L556'></a> 556                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on '" + <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../D/4196.html' title='Multiple defined in 5 places.'>cfg</a>["name"].<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>() + "' not found.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L557' name='L557'></a> 557         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L558' name='L558'></a> 558                 <strong class='reserved'>const</strong> <strong class='reserved'>int</strong> <a href='../D/14578.html' title='Multiple defined in 18 places.'>size</a> = <a href='../D/6226.html' title='Multiple defined in 6 places.'>filesystem</a>::<a href='../S/314.html#L878' title='Defined at 878 in src/filesystem_boost.cpp.'>file_size</a>(<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["filename"]);
<a id='L559' name='L559'></a> 559 
<a id='L560' name='L560'></a> 560                 <strong class='reserved'>if</strong>(<a href='../D/14578.html' title='Multiple defined in 18 places.'>size</a> &lt; 0) <em class='brace'>{</em>
<a id='L561' name='L561'></a> 561                         <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/7179.html' title='Multiple used in 228 places.'>cerr</a> &lt;&lt; " size: &lt;unknown&gt; KiB\n";
<a id='L562' name='L562'></a> 562                         <a href='../S/921.html#L58' title='Defined at 58 in src/campaign_server/campaign_server.cpp.'>ERR_CS</a> &lt;&lt; "File size unknown, aborting send.\n";
<a id='L563' name='L563'></a> 563                         <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on '" + <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../D/4196.html' title='Multiple defined in 5 places.'>cfg</a>["name"].<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>() + "' could not be read by the server.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L564' name='L564'></a> 564                         <strong class='reserved'>return</strong>;
<a id='L565' name='L565'></a> 565                 <em class='brace'>}</em>
<a id='L566' name='L566'></a> 566 
<a id='L567' name='L567'></a> 567                 <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/7179.html' title='Multiple used in 228 places.'>cerr</a> &lt;&lt; " size: " &lt;&lt; <a href='../D/14578.html' title='Multiple defined in 18 places.'>size</a>/1024 &lt;&lt; "KiB\n";
<a id='L568' name='L568'></a> 568                 async_send_file(<a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>, <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["filename"],
<a id='L569' name='L569'></a> 569                                 <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/3645.html' title='Multiple defined in 3 places.'>bind</a>(&amp;<a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../D/8386.html' title='Multiple defined in 2 places.'>handle_new_client</a>, <strong class='reserved'>this</strong>, <a href='../Y/4797.html' title='Multiple used in 111 places.'>_1</a>), <a href='../Y/15366.html' title='Multiple used in 3 places.'>null_handler</a>);
<a id='L570' name='L570'></a> 570                 <em class='comment'>// Clients doing upgrades or some other specific thing shouldn't bump</em>
<a id='L571' name='L571'></a> 571                 <em class='comment'>// the downloads count. Default to true for compatibility with old</em>
<a id='L572' name='L572'></a> 572                 <em class='comment'>// clients that won't tell us what they are trying to do.</em>
<a id='L573' name='L573'></a> 573                 <strong class='reserved'>if</strong>(<a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../D/4196.html' title='Multiple defined in 5 places.'>cfg</a>["increase_downloads"].<a href='../D/15259.html' title='Multiple defined in 2 places.'>to_bool</a>(<strong class='reserved'>true</strong>)) <em class='brace'>{</em>
<a id='L574' name='L574'></a> 574                         <strong class='reserved'>const</strong> <strong class='reserved'>int</strong> <a href='../Y/9067.html' title='Multiple used in 13 places.'>downloads</a> = <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["downloads"].<a href='../D/15269.html' title='Multiple defined in 2 places.'>to_int</a>() + 1;
<a id='L575' name='L575'></a> 575                         <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["downloads"] = <a href='../Y/9067.html' title='Multiple used in 13 places.'>downloads</a>;
<a id='L576' name='L576'></a> 576                 <em class='brace'>}</em>
<a id='L577' name='L577'></a> 577         <em class='brace'>}</em>
<a id='L578' name='L578'></a> 578 <em class='brace'>}</em>
<a id='L579' name='L579'></a> 579 
<a id='L580' name='L580'></a> 580 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../S/922.html#L168' title='Referred from 168 in src/campaign_server/campaign_server.hpp.'>handle_request_terms</a>(<strong class='reserved'>const</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../D/12850.html' title='Multiple defined in 3 places.'>request</a>&amp; <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>)
<a id='L581' name='L581'></a> 581 <em class='brace'>{</em>
<a id='L582' name='L582'></a> 582         <em class='comment'>// This usually means the client wants to upload content, so tell it</em>
<a id='L583' name='L583'></a> 583         <em class='comment'>// to give up when we're in read-only mode.</em>
<a id='L584' name='L584'></a> 584         <strong class='reserved'>if</strong>(<a href='../Y/17145.html' title='Multiple used in 16 places.'>read_only_</a>) <em class='brace'>{</em>
<a id='L585' name='L585'></a> 585                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "in read-only mode, request for upload terms denied\n";
<a id='L586' name='L586'></a> 586                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("The server is currently in read-only mode, add-on uploads are disabled.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L587' name='L587'></a> 587                 <strong class='reserved'>return</strong>;
<a id='L588' name='L588'></a> 588         <em class='brace'>}</em>
<a id='L589' name='L589'></a> 589 
<a id='L590' name='L590'></a> 590         <em class='comment'>// TODO: possibly move to server.cfg</em>
<a id='L591' name='L591'></a> 591         <strong class='reserved'>static</strong> <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a> <a href='../Y/19909.html' title='Multiple used in 6 places.'>terms</a> = <a href='../Y/2261.html' title='Multiple used in 19 places.'>R</a>"""(All content within add-ons uploaded to this server must be licensed under the terms of the GNU General Public License (GPL), with the sole exception of graphics and audio explicitly denoted as released under a Creative Commons license either in:
<a id='L592' name='L592'></a> 592 
<a id='L593' name='L593'></a> 593     a) a combined toplevel file, e.g. “My_Addon/ART_LICENSE”; &lt;b&gt;or&lt;/b&gt;
<a id='L594' name='L594'></a> 594     b) a file with the same path as the asset with “.license” appended, e.g. “My_Addon/images/units/axeman.png.license”.
<a id='L595' name='L595'></a> 595 
<a id='L596' name='L596'></a> 596 &lt;b&gt;By uploading content to <strong class='reserved'>this</strong> server, you certify that you have the right to:&lt;/b&gt;
<a id='L597' name='L597'></a> 597 
<a id='L598' name='L598'></a> 598     a) release all included art and audio explicitly denoted with a Creative Commons license in the proscribed manner under that license; &lt;b&gt;and&lt;/b&gt;
<a id='L599' name='L599'></a> 599     b) release all other included content under the terms of the GPL; and that you choose to <strong class='reserved'>do</strong> so.)""";
<a id='L600' name='L600'></a> 600 
<a id='L601' name='L601'></a> 601         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "sending terms " &lt;&lt; <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../S/922.html#L74' title='Defined at 74 in src/campaign_server/campaign_server.hpp.'>addr</a> &lt;&lt; "\n";
<a id='L602' name='L602'></a> 602         <a href='../S/921.html#L425' title='Defined at 425 in src/campaign_server/campaign_server.cpp.'>send_message</a>(<a href='../Y/19909.html' title='Multiple used in 6 places.'>terms</a>, <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L603' name='L603'></a> 603         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; " Done\n";
<a id='L604' name='L604'></a> 604 <em class='brace'>}</em>
<a id='L605' name='L605'></a> 605 
<a id='L606' name='L606'></a> 606 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../S/922.html#L169' title='Referred from 169 in src/campaign_server/campaign_server.hpp.'>handle_upload</a>(<strong class='reserved'>const</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../D/12850.html' title='Multiple defined in 3 places.'>request</a>&amp; <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>)
<a id='L607' name='L607'></a> 607 <em class='brace'>{</em>
<a id='L608' name='L608'></a> 608         <strong class='reserved'>const</strong> <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a> = <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../D/4196.html' title='Multiple defined in 5 places.'>cfg</a>;
<a id='L609' name='L609'></a> 609 
<a id='L610' name='L610'></a> 610         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "uploading campaign '" &lt;&lt; <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["name"] &lt;&lt; "' from " &lt;&lt; <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../S/922.html#L74' title='Defined at 74 in src/campaign_server/campaign_server.hpp.'>addr</a> &lt;&lt; ".\n";
<a id='L611' name='L611'></a> 611         <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a> <a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a> = <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>.<a href='../D/4417.html' title='Multiple defined in 14 places.'>child</a>("data");
<a id='L612' name='L612'></a> 612 
<a id='L613' name='L613'></a> 613         <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../D/11310.html' title='Multiple defined in 24 places.'>name</a> = <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["name"];
<a id='L614' name='L614'></a> 614         <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a> *<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a> = <a href='../Y/15374.html' title='Multiple used in 2007 places.'>nullptr</a>;
<a id='L615' name='L615'></a> 615 
<a id='L616' name='L616'></a> 616         <strong class='reserved'>bool</strong> <a href='../Y/16266.html' title='Multiple used in 3 places.'>passed_name_utf8_check</a> = <strong class='reserved'>false</strong>;
<a id='L617' name='L617'></a> 617 
<a id='L618' name='L618'></a> 618         <strong class='reserved'>try</strong> <em class='brace'>{</em>
<a id='L619' name='L619'></a> 619                 <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../Y/13048.html' title='Multiple used in 2 places.'>lc_name</a> = <a href='../D/15918.html' title='Multiple defined in 3 places.'>utf8</a>::<a href='../S/131.html#L51' title='Defined at 51 in src/serialization/unicode.cpp.'>lowercase</a>(<a href='../D/11310.html' title='Multiple defined in 24 places.'>name</a>);
<a id='L620' name='L620'></a> 620                 <a href='../Y/16266.html' title='Multiple used in 3 places.'>passed_name_utf8_check</a> = <strong class='reserved'>true</strong>;
<a id='L621' name='L621'></a> 621 
<a id='L622' name='L622'></a> 622                 <strong class='reserved'>for</strong>(<a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../D/3888.html' title='Multiple defined in 2 places.'>c</a> : <a href='../D/4086.html' title='Multiple defined in 2 places.'>campaigns</a>().<a href='../D/4431.html' title='Multiple defined in 2 places.'>child_range</a>("campaign"))
<a id='L623' name='L623'></a> 623                 <em class='brace'>{</em>
<a id='L624' name='L624'></a> 624                         <strong class='reserved'>if</strong>(<a href='../D/15918.html' title='Multiple defined in 3 places.'>utf8</a>::<a href='../S/131.html#L51' title='Defined at 51 in src/serialization/unicode.cpp.'>lowercase</a>(<a href='../D/3888.html' title='Multiple defined in 2 places.'>c</a>["name"]) == <a href='../Y/13048.html' title='Multiple used in 2 places.'>lc_name</a>) <em class='brace'>{</em>
<a id='L625' name='L625'></a> 625                                 <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a> = &amp;<a href='../D/3888.html' title='Multiple defined in 2 places.'>c</a>;
<a id='L626' name='L626'></a> 626                                 <strong class='reserved'>break</strong>;
<a id='L627' name='L627'></a> 627                         <em class='brace'>}</em>
<a id='L628' name='L628'></a> 628                 <em class='brace'>}</em>
<a id='L629' name='L629'></a> 629         <em class='brace'>}</em> <strong class='reserved'>catch</strong>(<strong class='reserved'>const</strong> <a href='../D/15918.html' title='Multiple defined in 3 places.'>utf8</a>::<a href='../S/128.html#L38' title='Defined at 38 in src/serialization/unicode_types.hpp.'>invalid_utf8_exception</a>&amp;) <em class='brace'>{</em>
<a id='L630' name='L630'></a> 630                 <strong class='reserved'>if</strong>(!<a href='../Y/16266.html' title='Multiple used in 3 places.'>passed_name_utf8_check</a>) <em class='brace'>{</em>
<a id='L631' name='L631'></a> 631                         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - invalid_utf8_exception caught on handle_upload() check 1, "
<a id='L632' name='L632'></a> 632                                    &lt;&lt; "the add-on pbl info contains invalid UTF-8\n";
<a id='L633' name='L633'></a> 633                         <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: The add-on name contains an invalid UTF-8 sequence.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L634' name='L634'></a> 634                 <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L635' name='L635'></a> 635                         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - invalid_utf8_exception caught on handle_upload() check 2, "
<a id='L636' name='L636'></a> 636                                    &lt;&lt; "the internal add-ons list contains invalid UTF-8\n";
<a id='L637' name='L637'></a> 637                         <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Server error: The server add-ons list is damaged.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L638' name='L638'></a> 638                 <em class='brace'>}</em>
<a id='L639' name='L639'></a> 639 
<a id='L640' name='L640'></a> 640                 <strong class='reserved'>return</strong>;
<a id='L641' name='L641'></a> 641         <em class='brace'>}</em>
<a id='L642' name='L642'></a> 642 
<a id='L643' name='L643'></a> 643         <strong class='reserved'>if</strong>(<a href='../Y/17145.html' title='Multiple used in 16 places.'>read_only_</a>) <em class='brace'>{</em>
<a id='L644' name='L644'></a> 644                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - uploads not permitted in read-only mode.\n";
<a id='L645' name='L645'></a> 645                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: The server is currently in read-only mode.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L646' name='L646'></a> 646         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(!<a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>) <em class='brace'>{</em>
<a id='L647' name='L647'></a> 647                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - no add-on data.\n";
<a id='L648' name='L648'></a> 648                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: No add-on data was supplied.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L649' name='L649'></a> 649         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(!<a href='../S/220.html#L49' title='Defined at 49 in src/addon/validation.cpp.'>addon_name_legal</a>(<a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["name"])) <em class='brace'>{</em>
<a id='L650' name='L650'></a> 650                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - invalid add-on name.\n";
<a id='L651' name='L651'></a> 651                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: The name of the add-on is invalid.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L652' name='L652'></a> 652         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../S/917.html#L31' title='Defined at 31 in src/campaign_server/addon_utils.hpp.'>is_text_markup_char</a>(<a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["name"].<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>()[0])) <em class='brace'>{</em>
<a id='L653' name='L653'></a> 653                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - add-on name starts with an illegal formatting character.\n";
<a id='L654' name='L654'></a> 654                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: The name of the add-on starts with an illegal formatting character.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L655' name='L655'></a> 655         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["title"].<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()) <em class='brace'>{</em>
<a id='L656' name='L656'></a> 656                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - no add-on title specified.\n";
<a id='L657' name='L657'></a> 657                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: You did not specify the title of the add-on in the pbl file!", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L658' name='L658'></a> 658         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../S/917.html#L31' title='Defined at 31 in src/campaign_server/addon_utils.hpp.'>is_text_markup_char</a>(<a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["title"].<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>()[0])) <em class='brace'>{</em>
<a id='L659' name='L659'></a> 659                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - add-on title starts with an illegal formatting character.\n";
<a id='L660' name='L660'></a> 660                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: The title of the add-on starts with an illegal formatting character.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L661' name='L661'></a> 661         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../S/220.html#L83' title='Defined at 83 in src/addon/validation.cpp.'>get_addon_type</a>(<a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["type"]) == <a href='../S/222.html#L41' title='Defined at 41 in src/addon/validation.hpp.'>ADDON_UNKNOWN</a>) <em class='brace'>{</em>
<a id='L662' name='L662'></a> 662                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - unknown add-on type specified.\n";
<a id='L663' name='L663'></a> 663                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: You did not specify a known type for the add-on in the pbl file! (See PblWML: wiki.wesnoth.org/PblWML)", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L664' name='L664'></a> 664         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["author"].<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()) <em class='brace'>{</em>
<a id='L665' name='L665'></a> 665                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - no add-on author specified.\n";
<a id='L666' name='L666'></a> 666                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: You did not specify the author(s) of the add-on in the pbl file!", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L667' name='L667'></a> 667         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["version"].<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()) <em class='brace'>{</em>
<a id='L668' name='L668'></a> 668                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - no add-on version specified.\n";
<a id='L669' name='L669'></a> 669                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: You did not specify the version of the add-on in the pbl file!", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L670' name='L670'></a> 670         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["description"].<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()) <em class='brace'>{</em>
<a id='L671' name='L671'></a> 671                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - no add-on description specified.\n";
<a id='L672' name='L672'></a> 672                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: You did not specify a description of the add-on in the pbl file!", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L673' name='L673'></a> 673         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["email"].<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()) <em class='brace'>{</em>
<a id='L674' name='L674'></a> 674                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - no add-on email specified.\n";
<a id='L675' name='L675'></a> 675                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: You did not specify your email address in the pbl file!", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L676' name='L676'></a> 676         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(!<a href='../S/220.html#L71' title='Defined at 71 in src/addon/validation.cpp.'>check_names_legal</a>(<a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>)) <em class='brace'>{</em>
<a id='L677' name='L677'></a> 677                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - invalid file names in add-on data.\n";
<a id='L678' name='L678'></a> 678                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: The add-on contains an illegal file or directory name."
<a id='L679' name='L679'></a> 679                                    " File or directory names may not contain whitespace or any of the following characters: '/ \\ : ~'",
<a id='L680' name='L680'></a> 680                                    <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L681' name='L681'></a> 681         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a> &amp;&amp; !<a href='../S/921.html#L72' title='Defined at 72 in src/campaign_server/campaign_server.cpp.'>authenticate</a>(*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>, <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["passphrase"])) <em class='brace'>{</em>
<a id='L682' name='L682'></a> 682                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - incorrect passphrase.\n";
<a id='L683' name='L683'></a> 683                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: The add-on already exists, and your passphrase was incorrect.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L684' name='L684'></a> 684         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L685' name='L685'></a> 685                 <strong class='reserved'>const</strong> <a href='../Y/20322.html' title='Multiple used in 138 places.'>time_t</a> <a href='../Y/21322.html' title='Multiple used in 3 places.'>upload_ts</a> = <a href='../D/15224.html' title='Multiple defined in 4 places.'>time</a>(<a href='../Y/15374.html' title='Multiple used in 2007 places.'>nullptr</a>);
<a id='L686' name='L686'></a> 686 
<a id='L687' name='L687'></a> 687                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload is owner upload.\n";
<a id='L688' name='L688'></a> 688 
<a id='L689' name='L689'></a> 689                 <strong class='reserved'>try</strong> <em class='brace'>{</em>
<a id='L690' name='L690'></a> 690                         <strong class='reserved'>if</strong>(<a href='../Y/6526.html' title='Multiple used in 5 places.'>blacklist_</a>.<a href='../S/915.html#L75' title='Defined at 75 in src/campaign_server/blacklist.cpp.'>is_blacklisted</a>(<a href='../D/11310.html' title='Multiple defined in 24 places.'>name</a>,
<a id='L691' name='L691'></a> 691                                                                                  <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["title"].<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>(),
<a id='L692' name='L692'></a> 692                                                                                  <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["description"].<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>(),
<a id='L693' name='L693'></a> 693                                                                                  <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["author"].<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>(),
<a id='L694' name='L694'></a> 694                                                                                  <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../S/922.html#L74' title='Defined at 74 in src/campaign_server/campaign_server.hpp.'>addr</a>,
<a id='L695' name='L695'></a> 695                                                                                  <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["email"].<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>()))
<a id='L696' name='L696'></a> 696                         <em class='brace'>{</em>
<a id='L697' name='L697'></a> 697                                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload denied - blacklisted add-on information.\n";
<a id='L698' name='L698'></a> 698                                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on upload denied. Please contact the server administration for assistance.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L699' name='L699'></a> 699                                 <strong class='reserved'>return</strong>;
<a id='L700' name='L700'></a> 700                         <em class='brace'>}</em>
<a id='L701' name='L701'></a> 701                 <em class='brace'>}</em> <strong class='reserved'>catch</strong>(<strong class='reserved'>const</strong> <a href='../D/15918.html' title='Multiple defined in 3 places.'>utf8</a>::<a href='../S/128.html#L38' title='Defined at 38 in src/serialization/unicode_types.hpp.'>invalid_utf8_exception</a>&amp;) <em class='brace'>{</em>
<a id='L702' name='L702'></a> 702                         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "Upload aborted - the add-on pbl info contains invalid UTF-8 and cannot be "
<a id='L703' name='L703'></a> 703                                    &lt;&lt; "checked against the blacklist\n";
<a id='L704' name='L704'></a> 704                         <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Add-on rejected: The add-on publish information contains an invalid UTF-8 sequence.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L705' name='L705'></a> 705                         <strong class='reserved'>return</strong>;
<a id='L706' name='L706'></a> 706                 <em class='brace'>}</em>
<a id='L707' name='L707'></a> 707 
<a id='L708' name='L708'></a> 708                 <strong class='reserved'>const</strong> <strong class='reserved'>bool</strong> <a href='../Y/9748.html' title='Multiple used in 2 places.'>existing_upload</a> = <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a> != <a href='../Y/15374.html' title='Multiple used in 2007 places.'>nullptr</a>;
<a id='L709' name='L709'></a> 709 
<a id='L710' name='L710'></a> 710                 <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a> <a href='../D/10972.html' title='Multiple defined in 7 places.'>message</a> = "Add-on accepted.";
<a id='L711' name='L711'></a> 711 
<a id='L712' name='L712'></a> 712                 <strong class='reserved'>if</strong>(<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a> == <a href='../Y/15374.html' title='Multiple used in 2007 places.'>nullptr</a>) <em class='brace'>{</em>
<a id='L713' name='L713'></a> 713                         <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a> = &amp;<a href='../D/4086.html' title='Multiple defined in 2 places.'>campaigns</a>().<a href='../D/2855.html' title='Multiple defined in 8 places.'>add_child</a>("campaign");
<a id='L714' name='L714'></a> 714                         (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["original_timestamp"] = <a href='../Y/21322.html' title='Multiple used in 3 places.'>upload_ts</a>;
<a id='L715' name='L715'></a> 715                 <em class='brace'>}</em>
<a id='L716' name='L716'></a> 716 
<a id='L717' name='L717'></a> 717                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["title"] = <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["title"];
<a id='L718' name='L718'></a> 718                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["name"] = <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["name"];
<a id='L719' name='L719'></a> 719                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["filename"] = "data/" + <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["name"].<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>();
<a id='L720' name='L720'></a> 720                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["author"] = <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["author"];
<a id='L721' name='L721'></a> 721                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["description"] = <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["description"];
<a id='L722' name='L722'></a> 722                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["version"] = <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["version"];
<a id='L723' name='L723'></a> 723                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["icon"] = <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["icon"];
<a id='L724' name='L724'></a> 724                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["translate"] = <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["translate"];
<a id='L725' name='L725'></a> 725                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["dependencies"] = <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["dependencies"];
<a id='L726' name='L726'></a> 726                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["upload_ip"] = <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../S/922.html#L74' title='Defined at 74 in src/campaign_server/campaign_server.hpp.'>addr</a>;
<a id='L727' name='L727'></a> 727                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["type"] = <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["type"];
<a id='L728' name='L728'></a> 728                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["email"] = <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["email"];
<a id='L729' name='L729'></a> 729 
<a id='L730' name='L730'></a> 730                 <strong class='reserved'>if</strong>(!<a href='../Y/9748.html' title='Multiple used in 2 places.'>existing_upload</a>) <em class='brace'>{</em>
<a id='L731' name='L731'></a> 731                         <a href='../S/921.html#L92' title='Defined at 92 in src/campaign_server/campaign_server.cpp.'>set_passphrase</a>(*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>, <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["passphrase"]);
<a id='L732' name='L732'></a> 732                 <em class='brace'>}</em>
<a id='L733' name='L733'></a> 733 
<a id='L734' name='L734'></a> 734                 <strong class='reserved'>if</strong>((*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["downloads"].<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()) <em class='brace'>{</em>
<a id='L735' name='L735'></a> 735                         (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["downloads"] = 0;
<a id='L736' name='L736'></a> 736                 <em class='brace'>}</em>
<a id='L737' name='L737'></a> 737                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["timestamp"] = <a href='../Y/21322.html' title='Multiple used in 3 places.'>upload_ts</a>;
<a id='L738' name='L738'></a> 738 
<a id='L739' name='L739'></a> 739                 <strong class='reserved'>int</strong> <a href='../Y/21323.html' title='Multiple used in 11 places.'>uploads</a> = (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["uploads"].<a href='../D/15269.html' title='Multiple defined in 2 places.'>to_int</a>() + 1;
<a id='L740' name='L740'></a> 740                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["uploads"] = <a href='../Y/21323.html' title='Multiple used in 11 places.'>uploads</a>;
<a id='L741' name='L741'></a> 741 
<a id='L742' name='L742'></a> 742                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>).<a href='../S/1105.html#L507' title='Defined at 507 in src/config.hpp.'>clear_children</a>("feedback");
<a id='L743' name='L743'></a> 743                 <strong class='reserved'>if</strong>(<strong class='reserved'>const</strong> <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../Y/21344.html' title='Multiple used in 5 places.'>url_params</a> = <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>.<a href='../D/4417.html' title='Multiple defined in 14 places.'>child</a>("feedback")) <em class='brace'>{</em>
<a id='L744' name='L744'></a> 744                         (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>).<a href='../D/2855.html' title='Multiple defined in 8 places.'>add_child</a>("feedback", <a href='../Y/21344.html' title='Multiple used in 5 places.'>url_params</a>);
<a id='L745' name='L745'></a> 745                 <em class='brace'>}</em>
<a id='L746' name='L746'></a> 746 
<a id='L747' name='L747'></a> 747                 <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>&amp; <a href='../D/6216.html' title='Multiple defined in 4 places.'>filename</a> = (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["filename"].<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>();
<a id='L748' name='L748'></a> 748                 <a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>["title"] = (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["title"];
<a id='L749' name='L749'></a> 749                 <a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>["name"] = "";
<a id='L750' name='L750'></a> 750                 <a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>["campaign_name"] = (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["name"];
<a id='L751' name='L751'></a> 751                 <a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>["author"] = (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["author"];
<a id='L752' name='L752'></a> 752                 <a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>["description"] = (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["description"];
<a id='L753' name='L753'></a> 753                 <a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>["version"] = (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["version"];
<a id='L754' name='L754'></a> 754                 <a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>["timestamp"] = (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["timestamp"];
<a id='L755' name='L755'></a> 755                 <a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>["original_timestamp"] = (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["original_timestamp"];
<a id='L756' name='L756'></a> 756                 <a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>["icon"] = (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["icon"];
<a id='L757' name='L757'></a> 757                 <a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>["type"] = (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["type"];
<a id='L758' name='L758'></a> 758                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>).<a href='../S/1105.html#L507' title='Defined at 507 in src/config.hpp.'>clear_children</a>("translation");
<a id='L759' name='L759'></a> 759                 <a href='../S/920.html#L95' title='Defined at 95 in src/campaign_server/addon_utils.cpp.'>find_translations</a>(<a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>, *<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>);
<a id='L760' name='L760'></a> 760 
<a id='L761' name='L761'></a> 761                 <a href='../S/920.html#L107' title='Defined at 107 in src/campaign_server/addon_utils.cpp.'>add_license</a>(<a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>);
<a id='L762' name='L762'></a> 762 
<a id='L763' name='L763'></a> 763                 <em class='brace'>{</em>
<a id='L764' name='L764'></a> 764                         <a href='../D/6226.html' title='Multiple defined in 6 places.'>filesystem</a>::<a href='../D/3445.html' title='Multiple defined in 2 places.'>atomic_commit</a> <a href='../Y/7037.html' title='Multiple used in 3 places.'>campaign_file</a>(<a href='../D/6216.html' title='Multiple defined in 4 places.'>filename</a>);
<a id='L765' name='L765'></a> 765                         <a href='../D/4790.html' title='Multiple defined in 2 places.'>config_writer</a> <a href='../S/1225.html#L182' title='Defined at 182 in src/lua/lstrlib.cpp.'>writer</a>(*<a href='../Y/7037.html' title='Multiple used in 3 places.'>campaign_file</a>.<a href='../S/916.html#L72' title='Defined at 72 in src/campaign_server/fs_commit.hpp.'>ostream</a>(), <strong class='reserved'>true</strong>, <a href='../Y/7773.html' title='Multiple used in 5 places.'>compress_level_</a>);
<a id='L766' name='L766'></a> 766                         <a href='../S/1225.html#L182' title='Defined at 182 in src/lua/lstrlib.cpp.'>writer</a>.<a href='../D/16565.html' title='Multiple defined in 55 places.'>write</a>(<a href='../D/5236.html' title='Multiple defined in 16 places.'>data</a>);
<a id='L767' name='L767'></a> 767                         <a href='../Y/7037.html' title='Multiple used in 3 places.'>campaign_file</a>.<a href='../D/4656.html' title='Multiple defined in 2 places.'>commit</a>();
<a id='L768' name='L768'></a> 768                 <em class='brace'>}</em>
<a id='L769' name='L769'></a> 769 
<a id='L770' name='L770'></a> 770                 (*<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>)["size"] = <a href='../D/6226.html' title='Multiple defined in 6 places.'>filesystem</a>::<a href='../S/314.html#L878' title='Defined at 878 in src/filesystem_boost.cpp.'>file_size</a>(<a href='../D/6216.html' title='Multiple defined in 4 places.'>filename</a>);
<a id='L771' name='L771'></a> 771 
<a id='L772' name='L772'></a> 772                 <a href='../D/16579.html' title='Multiple defined in 4 places.'>write_config</a>();
<a id='L773' name='L773'></a> 773 
<a id='L774' name='L774'></a> 774                 <a href='../S/921.html#L425' title='Defined at 425 in src/campaign_server/campaign_server.cpp.'>send_message</a>(<a href='../D/10972.html' title='Multiple defined in 7 places.'>message</a>, <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L775' name='L775'></a> 775 
<a id='L776' name='L776'></a> 776                 <a href='../D/6376.html' title='Multiple defined in 11 places.'>fire</a>("hook_post_upload", <a href='../S/4095.html#L281' title='Defined at 281 in data/tools/wesnoth/wescamp.py.'>upload</a>["name"]);
<a id='L777' name='L777'></a> 777         <em class='brace'>}</em>
<a id='L778' name='L778'></a> 778 <em class='brace'>}</em>
<a id='L779' name='L779'></a> 779 
<a id='L780' name='L780'></a> 780 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../R/7501.html' title='Multiple referred from 5 places.'>handle_delete</a>(<strong class='reserved'>const</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../D/12850.html' title='Multiple defined in 3 places.'>request</a>&amp; <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>)
<a id='L781' name='L781'></a> 781 <em class='brace'>{</em>
<a id='L782' name='L782'></a> 782         <strong class='reserved'>const</strong> <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../D/5969.html' title='Multiple defined in 12 places.'>erase</a> = <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../D/4196.html' title='Multiple defined in 5 places.'>cfg</a>;
<a id='L783' name='L783'></a> 783 
<a id='L784' name='L784'></a> 784         <strong class='reserved'>if</strong>(<a href='../Y/17145.html' title='Multiple used in 16 places.'>read_only_</a>) <em class='brace'>{</em>
<a id='L785' name='L785'></a> 785                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "in read-only mode, request to delete '" &lt;&lt; <a href='../D/5969.html' title='Multiple defined in 12 places.'>erase</a>["name"] &lt;&lt; "' from " &lt;&lt; <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../S/922.html#L74' title='Defined at 74 in src/campaign_server/campaign_server.hpp.'>addr</a> &lt;&lt; " denied\n";
<a id='L786' name='L786'></a> 786                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Cannot delete add-on: The server is currently in read-only mode.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L787' name='L787'></a> 787                 <strong class='reserved'>return</strong>;
<a id='L788' name='L788'></a> 788         <em class='brace'>}</em>
<a id='L789' name='L789'></a> 789 
<a id='L790' name='L790'></a> 790         <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "deleting campaign '" &lt;&lt; <a href='../D/5969.html' title='Multiple defined in 12 places.'>erase</a>["name"] &lt;&lt; "' requested from " &lt;&lt; <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../S/922.html#L74' title='Defined at 74 in src/campaign_server/campaign_server.hpp.'>addr</a> &lt;&lt; "\n";
<a id='L791' name='L791'></a> 791 
<a id='L792' name='L792'></a> 792         <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a> = <a href='../D/7380.html' title='Multiple defined in 2 places.'>get_campaign</a>(<a href='../D/5969.html' title='Multiple defined in 12 places.'>erase</a>["name"]);
<a id='L793' name='L793'></a> 793 
<a id='L794' name='L794'></a> 794         <strong class='reserved'>if</strong>(!<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>) <em class='brace'>{</em>
<a id='L795' name='L795'></a> 795                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("The add-on does not exist.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L796' name='L796'></a> 796                 <strong class='reserved'>return</strong>;
<a id='L797' name='L797'></a> 797         <em class='brace'>}</em>
<a id='L798' name='L798'></a> 798 
<a id='L799' name='L799'></a> 799         <strong class='reserved'>if</strong>(!<a href='../S/921.html#L72' title='Defined at 72 in src/campaign_server/campaign_server.cpp.'>authenticate</a>(<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>, <a href='../D/5969.html' title='Multiple defined in 12 places.'>erase</a>["passphrase"])
<a id='L800' name='L800'></a> 800                 &amp;&amp; (<a href='../D/4086.html' title='Multiple defined in 2 places.'>campaigns</a>()["master_password"].<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()
<a id='L801' name='L801'></a> 801                 || <a href='../D/4086.html' title='Multiple defined in 2 places.'>campaigns</a>()["master_password"] != <a href='../D/5969.html' title='Multiple defined in 12 places.'>erase</a>["passphrase"]))
<a id='L802' name='L802'></a> 802         <em class='brace'>{</em>
<a id='L803' name='L803'></a> 803                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("The passphrase is incorrect.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L804' name='L804'></a> 804                 <strong class='reserved'>return</strong>;
<a id='L805' name='L805'></a> 805         <em class='brace'>}</em>
<a id='L806' name='L806'></a> 806 
<a id='L807' name='L807'></a> 807         <em class='comment'>// Erase the campaign.</em>
<a id='L808' name='L808'></a> 808         <a href='../D/6226.html' title='Multiple defined in 6 places.'>filesystem</a>::<a href='../D/16584.html' title='Multiple defined in 4 places.'>write_file</a>(<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["filename"], <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a>());
<a id='L809' name='L809'></a> 809         <strong class='reserved'>if</strong>(<a href='../D/12673.html' title='Multiple defined in 8 places.'>remove</a>(<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["filename"].<a href='../D/14803.html' title='Multiple defined in 25 places.'>str</a>().<a href='../D/3892.html' title='Multiple defined in 2 places.'>c_str</a>()) != 0) <em class='brace'>{</em>
<a id='L810' name='L810'></a> 810                 <a href='../S/921.html#L58' title='Defined at 58 in src/campaign_server/campaign_server.cpp.'>ERR_CS</a> &lt;&lt; "failed to delete archive for campaign '" &lt;&lt; <a href='../D/5969.html' title='Multiple defined in 12 places.'>erase</a>["name"]
<a id='L811' name='L811'></a> 811                            &lt;&lt; "' (" &lt;&lt; <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>["filename"] &lt;&lt; "): " &lt;&lt; <a href='../Y/19390.html' title='Multiple used in 13 places.'>strerror</a>(<a href='../Y/9614.html' title='Multiple used in 17 places.'>errno</a>)
<a id='L812' name='L812'></a> 812                            &lt;&lt; '\n';
<a id='L813' name='L813'></a> 813         <em class='brace'>}</em>
<a id='L814' name='L814'></a> 814 
<a id='L815' name='L815'></a> 815         <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>::<a href='../S/1105.html#L235' title='Defined at 235 in src/config.hpp.'>child_itors</a> <a href='../Y/12609.html' title='Multiple used in 44 places.'>itors</a> = <a href='../D/4086.html' title='Multiple defined in 2 places.'>campaigns</a>().<a href='../D/4431.html' title='Multiple defined in 2 places.'>child_range</a>("campaign");
<a id='L816' name='L816'></a> 816         <strong class='reserved'>for</strong>(<a href='../Y/18861.html' title='Multiple used in 1749 places.'>size_t</a> <a href='../D/8854.html' title='Multiple defined in 6 places.'>index</a> = 0; !<a href='../Y/12609.html' title='Multiple used in 44 places.'>itors</a>.<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>(); ++<a href='../D/8854.html' title='Multiple defined in 6 places.'>index</a>, <a href='../Y/12609.html' title='Multiple used in 44 places.'>itors</a>.<a href='../S/863.html#L265' title='Defined at 265 in src/utils/smart_list.hpp.'>pop_front</a>())
<a id='L817' name='L817'></a> 817         <em class='brace'>{</em>
<a id='L818' name='L818'></a> 818                 <strong class='reserved'>if</strong>(&amp;<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a> == &amp;<a href='../Y/12609.html' title='Multiple used in 44 places.'>itors</a>.<a href='../D/6560.html' title='Multiple defined in 5 places.'>front</a>()) <em class='brace'>{</em>
<a id='L819' name='L819'></a> 819                         <a href='../D/4086.html' title='Multiple defined in 2 places.'>campaigns</a>().<a href='../D/12694.html' title='Multiple defined in 6 places.'>remove_child</a>("campaign", <a href='../D/8854.html' title='Multiple defined in 6 places.'>index</a>);
<a id='L820' name='L820'></a> 820                         <strong class='reserved'>break</strong>;
<a id='L821' name='L821'></a> 821                 <em class='brace'>}</em>
<a id='L822' name='L822'></a> 822         <em class='brace'>}</em>
<a id='L823' name='L823'></a> 823 
<a id='L824' name='L824'></a> 824         <a href='../D/16579.html' title='Multiple defined in 4 places.'>write_config</a>();
<a id='L825' name='L825'></a> 825 
<a id='L826' name='L826'></a> 826         <a href='../S/921.html#L425' title='Defined at 425 in src/campaign_server/campaign_server.cpp.'>send_message</a>("Add-on deleted.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L827' name='L827'></a> 827 
<a id='L828' name='L828'></a> 828         <a href='../D/6376.html' title='Multiple defined in 11 places.'>fire</a>("hook_post_erase", <a href='../D/5969.html' title='Multiple defined in 12 places.'>erase</a>["name"]);
<a id='L829' name='L829'></a> 829 
<a id='L830' name='L830'></a> 830 <em class='brace'>}</em>
<a id='L831' name='L831'></a> 831 
<a id='L832' name='L832'></a> 832 <strong class='reserved'>void</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../S/922.html#L171' title='Referred from 171 in src/campaign_server/campaign_server.hpp.'>handle_change_passphrase</a>(<strong class='reserved'>const</strong> <a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>::<a href='../D/12850.html' title='Multiple defined in 3 places.'>request</a>&amp; <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>)
<a id='L833' name='L833'></a> 833 <em class='brace'>{</em>
<a id='L834' name='L834'></a> 834         <strong class='reserved'>const</strong> <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../Y/7999.html' title='Multiple used in 5 places.'>cpass</a> = <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../D/4196.html' title='Multiple defined in 5 places.'>cfg</a>;
<a id='L835' name='L835'></a> 835 
<a id='L836' name='L836'></a> 836         <strong class='reserved'>if</strong>(<a href='../Y/17145.html' title='Multiple used in 16 places.'>read_only_</a>) <em class='brace'>{</em>
<a id='L837' name='L837'></a> 837                 <a href='../D/1089.html' title='Multiple defined in 2 places.'>LOG_CS</a> &lt;&lt; "in read-only mode, request to change passphrase denied\n";
<a id='L838' name='L838'></a> 838                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Cannot change passphrase: The server is currently in read-only mode.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L839' name='L839'></a> 839                 <strong class='reserved'>return</strong>;
<a id='L840' name='L840'></a> 840         <em class='brace'>}</em>
<a id='L841' name='L841'></a> 841 
<a id='L842' name='L842'></a> 842         <a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>&amp; <a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a> = <a href='../D/7380.html' title='Multiple defined in 2 places.'>get_campaign</a>(<a href='../Y/7999.html' title='Multiple used in 5 places.'>cpass</a>["name"]);
<a id='L843' name='L843'></a> 843 
<a id='L844' name='L844'></a> 844         <strong class='reserved'>if</strong>(!<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>) <em class='brace'>{</em>
<a id='L845' name='L845'></a> 845                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("No add-on with that name exists.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L846' name='L846'></a> 846         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(!<a href='../S/921.html#L72' title='Defined at 72 in src/campaign_server/campaign_server.cpp.'>authenticate</a>(<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>, <a href='../Y/7999.html' title='Multiple used in 5 places.'>cpass</a>["passphrase"])) <em class='brace'>{</em>
<a id='L847' name='L847'></a> 847                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("Your old passphrase was incorrect.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L848' name='L848'></a> 848         <em class='brace'>}</em> <strong class='reserved'>else</strong> <strong class='reserved'>if</strong>(<a href='../Y/7999.html' title='Multiple used in 5 places.'>cpass</a>["new_passphrase"].<a href='../D/5865.html' title='Multiple defined in 31 places.'>empty</a>()) <em class='brace'>{</em>
<a id='L849' name='L849'></a> 849                 <a href='../D/13488.html' title='Multiple defined in 2 places.'>send_error</a>("No new passphrase was supplied.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L850' name='L850'></a> 850         <em class='brace'>}</em> <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L851' name='L851'></a> 851                 <a href='../S/921.html#L92' title='Defined at 92 in src/campaign_server/campaign_server.cpp.'>set_passphrase</a>(<a href='../S/1119.html#L221' title='Defined at 221 in src/game_initialization/create_engine.hpp.'>campaign</a>, <a href='../Y/7999.html' title='Multiple used in 5 places.'>cpass</a>["new_passphrase"]);
<a id='L852' name='L852'></a> 852                 <a href='../D/16579.html' title='Multiple defined in 4 places.'>write_config</a>();
<a id='L853' name='L853'></a> 853                 <a href='../S/921.html#L425' title='Defined at 425 in src/campaign_server/campaign_server.cpp.'>send_message</a>("Passphrase changed.", <a href='../Y/17556.html' title='Multiple used in 83 places.'>req</a>.<a href='../Y/18954.html' title='Multiple used in 183 places.'>sock</a>);
<a id='L854' name='L854'></a> 854         <em class='brace'>}</em>
<a id='L855' name='L855'></a> 855 <em class='brace'>}</em>
<a id='L856' name='L856'></a> 856 
<a id='L857' name='L857'></a> 857 <em class='brace'>}</em> <em class='comment'>// end namespace campaignd</em>
<a id='L858' name='L858'></a> 858 
<a id='L859' name='L859'></a> 859 <strong class='reserved'>int</strong> <a href='../R/9732.html' title='Multiple referred from 55 places.'>main</a>()
<a id='L860' name='L860'></a> 860 <em class='brace'>{</em>
<a id='L861' name='L861'></a> 861         <a href='../D/6619.html' title='Multiple defined in 7 places.'>game_config</a>::<a href='../D/11848.html' title='Multiple defined in 6 places.'>path</a> = <a href='../D/6226.html' title='Multiple defined in 6 places.'>filesystem</a>::<a href='../S/314.html#L661' title='Defined at 661 in src/filesystem_boost.cpp.'>get_cwd</a>();
<a id='L862' name='L862'></a> 862 
<a id='L863' name='L863'></a> 863         <a href='../D/9809.html' title='Multiple defined in 5 places.'>lg</a>::<a href='../D/13916.html' title='Multiple defined in 2 places.'>set_log_domain_severity</a>("campaignd", <a href='../D/9809.html' title='Multiple defined in 5 places.'>lg</a>::<a href='../D/8860.html' title='Multiple defined in 2 places.'>info</a>());
<a id='L864' name='L864'></a> 864         <a href='../D/9809.html' title='Multiple defined in 5 places.'>lg</a>::<a href='../D/13916.html' title='Multiple defined in 2 places.'>set_log_domain_severity</a>("server", <a href='../D/9809.html' title='Multiple defined in 5 places.'>lg</a>::<a href='../D/8860.html' title='Multiple defined in 2 places.'>info</a>());
<a id='L865' name='L865'></a> 865         <a href='../D/9809.html' title='Multiple defined in 5 places.'>lg</a>::<a href='../S/847.html#L76' title='Defined at 76 in src/log.cpp.'>timestamps</a>(<strong class='reserved'>true</strong>);
<a id='L866' name='L866'></a> 866 
<a id='L867' name='L867'></a> 867         <strong class='reserved'>try</strong> <em class='brace'>{</em>
<a id='L868' name='L868'></a> 868                 <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/7179.html' title='Multiple used in 228 places.'>cerr</a> &lt;&lt; "Wesnoth campaignd v" &lt;&lt; <a href='../D/6619.html' title='Multiple defined in 7 places.'>game_config</a>::<a href='../Y/17738.html' title='Multiple used in 14 places.'>revision</a> &lt;&lt; " starting...\n";
<a id='L869' name='L869'></a> 869 
<a id='L870' name='L870'></a> 870                 <strong class='reserved'>const</strong> <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../D/14836.html' title='Multiple defined in 3 places.'>string</a> <a href='../Y/7202.html' title='Multiple used in 5 places.'>cfg_path</a> = <a href='../D/6226.html' title='Multiple defined in 6 places.'>filesystem</a>::<a href='../S/314.html#L996' title='Defined at 996 in src/filesystem_boost.cpp.'>normalize_path</a>("server.cfg");
<a id='L871' name='L871'></a> 871 
<a id='L872' name='L872'></a> 872                 <a href='../D/4084.html' title='Multiple defined in 7 places.'>campaignd</a>::<a href='../D/13525.html' title='Multiple defined in 5 places.'>server</a>(<a href='../Y/7202.html' title='Multiple used in 5 places.'>cfg_path</a>).<a href='../D/13193.html' title='Multiple defined in 57 places.'>run</a>();
<a id='L873' name='L873'></a> 873         <em class='brace'>}</em> <strong class='reserved'>catch</strong>(<a href='../D/4769.html' title='Multiple defined in 5 places.'>config</a>::<a href='../D/5980.html' title='Multiple defined in 22 places.'>error</a>&amp; <em class='comment'>/*e*/</em>) <em class='brace'>{</em>
<a id='L874' name='L874'></a> 874                 <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/7179.html' title='Multiple used in 228 places.'>cerr</a> &lt;&lt; "Could not parse config file\n";
<a id='L875' name='L875'></a> 875                 <strong class='reserved'>return</strong> 1;
<a id='L876' name='L876'></a> 876         <em class='brace'>}</em> <strong class='reserved'>catch</strong>(<a href='../D/6226.html' title='Multiple defined in 6 places.'>filesystem</a>::<a href='../S/1257.html#L46' title='Defined at 46 in src/filesystem.hpp.'>io_exception</a>&amp; <a href='../D/5774.html' title='Multiple defined in 3 places.'>e</a>) <em class='brace'>{</em>
<a id='L877' name='L877'></a> 877                 <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/7179.html' title='Multiple used in 228 places.'>cerr</a> &lt;&lt; "File I/O error: " &lt;&lt; <a href='../D/5774.html' title='Multiple defined in 3 places.'>e</a>.<a href='../D/16349.html' title='Multiple defined in 8 places.'>what</a>() &lt;&lt; "\n";
<a id='L878' name='L878'></a> 878                 <strong class='reserved'>return</strong> 2;
<a id='L879' name='L879'></a> 879         <em class='brace'>}</em> <strong class='reserved'>catch</strong>(<a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/6241.html' title='Multiple used in 2 places.'>bad_function_call</a>&amp; <em class='comment'>/*e*/</em>) <em class='brace'>{</em>
<a id='L880' name='L880'></a> 880                 <a href='../D/14775.html' title='Multiple defined in 5 places.'>std</a>::<a href='../Y/7179.html' title='Multiple used in 228 places.'>cerr</a> &lt;&lt; "Bad request handler function call\n";
<a id='L881' name='L881'></a> 881                 <strong class='reserved'>return</strong> 4;
<a id='L882' name='L882'></a> 882         <em class='brace'>}</em>
<a id='L883' name='L883'></a> 883 
<a id='L884' name='L884'></a> 884         <strong class='reserved'>return</strong> 0;
<a id='L885' name='L885'></a> 885 <em class='brace'>}</em>
</pre>
<hr />
<a id='BOTTOM' name='BOTTOM'></a>
<em class='comment'>/* [&lt;][&gt;]<a href='#L72'>[^]</a><a href='#L859'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</em>
</body>
</html>
