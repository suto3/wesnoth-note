<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>messenger</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.6' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/4281.html#L7'>messenger</a>           7 data/ai/micro_ais/cas/ca_messenger_attack.lua local function messenger_find_enemies_in_way(messenger, goal_x, goal_y)</span>
<span class='curline'><a href='../S/4281.html#L13'>messenger</a>          13 data/ai/micro_ais/cas/ca_messenger_attack.lua     local path, cost = AH.find_path_with_shroud(messenger, goal_x, goal_y, { ignore_units = true })</span>
<span class='curline'><a href='../S/4281.html#L26'>messenger</a>          26 data/ai/micro_ais/cas/ca_messenger_attack.lua         local sub_path, sub_cost = AH.find_path_with_shroud(messenger, path[i][1], path[i][2], { ignore_units = true })</span>
<span class='curline'><a href='../S/4281.html#L27'>messenger</a>          27 data/ai/micro_ais/cas/ca_messenger_attack.lua         if (sub_cost &lt;= messenger.moves) then</span>
<span class='curline'><a href='../S/4281.html#L38'>messenger</a>          38 data/ai/micro_ais/cas/ca_messenger_attack.lua local function messenger_find_clearing_attack(messenger, goal_x, goal_y, cfg)</span>
<span class='curline'><a href='../S/4281.html#L45'>messenger</a>          45 data/ai/micro_ais/cas/ca_messenger_attack.lua     local enemy_in_way = messenger_find_enemies_in_way(messenger, goal_x, goal_y)</span>
<span class='curline'><a href='../S/4281.html#L98'>messenger</a>          98 data/ai/micro_ais/cas/ca_messenger_attack.lua     local messenger, x, y = messenger_next_waypoint(cfg)</span>
<span class='curline'><a href='../S/4281.html#L99'>messenger</a>          99 data/ai/micro_ais/cas/ca_messenger_attack.lua     if (not messenger) then return 0 end</span>
<span class='curline'><a href='../S/4281.html#L101'>messenger</a>         101 data/ai/micro_ais/cas/ca_messenger_attack.lua     local attack = messenger_find_clearing_attack(messenger, x, y, cfg)</span>
<span class='curline'><a href='../S/4318.html#L27'>messenger</a>          27 data/ai/micro_ais/cas/ca_messenger_f_next_waypoint.lua     for _,messenger in ipairs(messengers) do</span>
<span class='curline'><a href='../S/4318.html#L30'>messenger</a>          30 data/ai/micro_ais/cas/ca_messenger_f_next_waypoint.lua         local wp_i = MAIUV.get_mai_unit_variables(messenger, cfg.ai_id, "wp_i") or 1</span>
<span class='curline'><a href='../S/4318.html#L35'>messenger</a>          35 data/ai/micro_ais/cas/ca_messenger_f_next_waypoint.lua         local dist_wp = wesnoth.map.distance_between(messenger.x, messenger.y, wp_x, wp_y)</span>
<span class='curline'><a href='../S/4318.html#L45'>messenger</a>          45 data/ai/micro_ais/cas/ca_messenger_f_next_waypoint.lua         MAIUV.set_mai_unit_variables(messenger, cfg.ai_id, { wp_i = wp_i, wp_x = wp_x, wp_y = wp_y, wp_rating = rating })</span>
<span class='curline'><a href='../S/4318.html#L47'>messenger</a>          47 data/ai/micro_ais/cas/ca_messenger_f_next_waypoint.lua         if (messenger.moves &gt; 0) and (rating &gt; max_rating) then</span>
<span class='curline'><a href='../S/4318.html#L48'>messenger</a>          48 data/ai/micro_ais/cas/ca_messenger_f_next_waypoint.lua             best_messenger, max_rating = messenger, rating</span>
<span class='curline'><a href='../S/4305.html#L10'>messenger</a>          10 data/ai/micro_ais/cas/ca_messenger_move.lua     local messenger = messenger_next_waypoint(cfg)</span>
<span class='curline'><a href='../S/4305.html#L12'>messenger</a>          12 data/ai/micro_ais/cas/ca_messenger_move.lua     if messenger then return cfg.ca_score end</span>
<span class='curline'><a href='../S/4305.html#L17'>messenger</a>          17 data/ai/micro_ais/cas/ca_messenger_move.lua     local messenger, x, y = messenger_next_waypoint(cfg)</span>
<span class='curline'><a href='../S/4305.html#L19'>messenger</a>          19 data/ai/micro_ais/cas/ca_messenger_move.lua     if (messenger.x ~= x) or (messenger.y ~= y) then</span>
<span class='curline'><a href='../S/4305.html#L23'>messenger</a>          23 data/ai/micro_ais/cas/ca_messenger_move.lua             messenger</span>
<span class='curline'><a href='../S/4305.html#L28'>messenger</a>          28 data/ai/micro_ais/cas/ca_messenger_move.lua     local next_hop = AH.next_hop(messenger, x, y, { ignore_own_units = true } )</span>
<span class='curline'><a href='../S/4305.html#L29'>messenger</a>          29 data/ai/micro_ais/cas/ca_messenger_move.lua     if (not next_hop) then next_hop = { messenger.x, messenger.y } end</span>
<span class='curline'><a href='../S/4305.html#L32'>messenger</a>          32 data/ai/micro_ais/cas/ca_messenger_move.lua     local path = AH.find_path_with_shroud(messenger, x, y, { ignore_units = 'yes' })</span>
<span class='curline'><a href='../S/4305.html#L33'>messenger</a>          33 data/ai/micro_ais/cas/ca_messenger_move.lua     local optimum_hop, optimum_cost = { messenger.x, messenger.y }, 0</span>
<span class='curline'><a href='../S/4305.html#L35'>messenger</a>          35 data/ai/micro_ais/cas/ca_messenger_move.lua         local sub_path, sub_cost = AH.find_path_with_shroud(messenger, step[1], step[2])</span>
<span class='curline'><a href='../S/4305.html#L36'>messenger</a>          36 data/ai/micro_ais/cas/ca_messenger_move.lua         if sub_cost &gt; messenger.moves then</span>
<span class='curline'><a href='../S/4305.html#L44'>messenger</a>          44 data/ai/micro_ais/cas/ca_messenger_move.lua             if unit_in_way and (unit_in_way.side == messenger.side) then</span>
<span class='curline'><a href='../S/4305.html#L56'>messenger</a>          56 data/ai/micro_ais/cas/ca_messenger_move.lua     local x_current, y_current = messenger.x, messenger.y</span>
<span class='curline'><a href='../S/4305.html#L59'>messenger</a>          59 data/ai/micro_ais/cas/ca_messenger_move.lua     if (unit_in_way == messenger) then unit_in_way = nil end</span>
<span class='curline'><a href='../S/4305.html#L62'>messenger</a>          62 data/ai/micro_ais/cas/ca_messenger_move.lua     wesnoth.put_unit(messenger, next_hop[1], next_hop[2])</span>
<span class='curline'><a href='../S/4305.html#L63'>messenger</a>          63 data/ai/micro_ais/cas/ca_messenger_move.lua     local _, cost1 = AH.find_path_with_shroud(messenger, x, y, { ignore_units = 'yes' })</span>
<span class='curline'><a href='../S/4305.html#L66'>messenger</a>          66 data/ai/micro_ais/cas/ca_messenger_move.lua     if (unit_in_way2 == messenger) then unit_in_way2 = nil end</span>
<span class='curline'><a href='../S/4305.html#L69'>messenger</a>          69 data/ai/micro_ais/cas/ca_messenger_move.lua     wesnoth.put_unit(messenger, optimum_hop[1], optimum_hop[2])</span>
<span class='curline'><a href='../S/4305.html#L70'>messenger</a>          70 data/ai/micro_ais/cas/ca_messenger_move.lua     local _, cost2 = AH.find_path_with_shroud(messenger, x, y, { ignore_units = 'yes' })</span>
<span class='curline'><a href='../S/4305.html#L72'>messenger</a>          72 data/ai/micro_ais/cas/ca_messenger_move.lua     wesnoth.put_unit(messenger, x_current, y_current)</span>
<span class='curline'><a href='../S/4305.html#L78'>messenger</a>          78 data/ai/micro_ais/cas/ca_messenger_move.lua     if (cost2 + messenger.max_moves/2 &lt; cost1) then next_hop = optimum_hop end</span>
<span class='curline'><a href='../S/4305.html#L80'>messenger</a>          80 data/ai/micro_ais/cas/ca_messenger_move.lua     if next_hop and ((next_hop[1] ~= messenger.x) or (next_hop[2] ~= messenger.y)) then</span>
<span class='curline'><a href='../S/4305.html#L81'>messenger</a>          81 data/ai/micro_ais/cas/ca_messenger_move.lua         AH.robust_move_and_attack(ai, messenger, next_hop)</span>
<span class='curline'><a href='../S/4305.html#L83'>messenger</a>          83 data/ai/micro_ais/cas/ca_messenger_move.lua         AH.checked_stopunit_moves(ai, messenger)</span>
<span class='curline'><a href='../S/4305.html#L85'>messenger</a>          85 data/ai/micro_ais/cas/ca_messenger_move.lua     if (not messenger) or (not messenger.valid) then return end</span>
<span class='curline'><a href='../S/4305.html#L88'>messenger</a>          88 data/ai/micro_ais/cas/ca_messenger_move.lua     if (messenger.attacks_left &lt;= 0) then return end</span>
<span class='curline'><a href='../S/4305.html#L89'>messenger</a>          89 data/ai/micro_ais/cas/ca_messenger_move.lua     if (#messenger.attacks == 0) then return end</span>
<span class='curline'><a href='../S/4305.html#L91'>messenger</a>          91 data/ai/micro_ais/cas/ca_messenger_move.lua     local targets = AH.get_attackable_enemies { { "filter_adjacent", { id = messenger.id } } }</span>
<span class='curline'><a href='../S/4305.html#L95'>messenger</a>          95 data/ai/micro_ais/cas/ca_messenger_move.lua         for n_weapon,weapon in ipairs(messenger.attacks) do</span>
<span class='curline'><a href='../S/4305.html#L96'>messenger</a>          96 data/ai/micro_ais/cas/ca_messenger_move.lua             local att_stats, def_stats = wesnoth.simulate_combat(messenger, n_weapon, target)</span>
<span class='curline'><a href='../S/4305.html#L106'>messenger</a>         106 data/ai/micro_ais/cas/ca_messenger_move.lua             if (att_stats.hp_chance[messenger.hitpoints] == 1)</span>
<span class='curline'><a href='../S/4305.html#L119'>messenger</a>         119 data/ai/micro_ais/cas/ca_messenger_move.lua         AH.checked_attack(ai, messenger, best_target, best_weapon)</span>
<span class='curline'><a href='../S/4305.html#L127'>messenger</a>         127 data/ai/micro_ais/cas/ca_messenger_move.lua             { "filter_adjacent", { id = messenger.id } }</span>
<span class='curline'><a href='../S/4305.html#L131'>messenger</a>         131 data/ai/micro_ais/cas/ca_messenger_move.lua             AH.checked_attack(ai, messenger, target)</span>
<span class='curline'><a href='../S/4305.html#L134'>messenger</a>         134 data/ai/micro_ais/cas/ca_messenger_move.lua     if (not messenger) or (not messenger.valid) then return end</span>
<span class='curline'><a href='../S/4305.html#L136'>messenger</a>         136 data/ai/micro_ais/cas/ca_messenger_move.lua     AH.checked_stopunit_attacks(ai, messenger)</span>
</pre>
</body>
</html>
